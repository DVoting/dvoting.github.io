var fe=Object.defineProperty,ye=Object.defineProperties;var ve=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var we=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable;var le=(t,r,n)=>r in t?fe(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,P=(t,r)=>{for(var n in r||(r={}))we.call(r,n)&&le(t,n,r[n]);if(oe)for(var n of oe(r))xe.call(r,n)&&le(t,n,r[n]);return t},L=(t,r)=>ye(t,ve(r));import{r as i,j as e,W as Z,a,R as w,t as G,N as ee,C as U,b as K,c as _,F as D,d as be,e as Ce,f as Se,V as Ie,B as Ne,g as ie,h as N,i as ce,k as A,A as ke,l as Ee,M as Te,m as Oe,n as Pe,S as Le,o as De,p as Ae,q as B,s as k,u as $e,v as He,w as j,x as $,y as J,z as c,L as H,D as q,E as ze,G as Q,H as S,T as Re,I as X,J as de,K as Fe,O as ue,P as Be,Q as Me,U as E,X as qe,Y as Ve}from"./vendor.87716a87.js";const je=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const h of l.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&o(h)}).observe(document,{childList:!0,subtree:!0});function n(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerpolicy&&(l.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?l.credentials="include":s.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(s){if(s.ep)return;s.ep=!0;const l=n(s);fetch(s.href,l)}};je();const T=i.exports.createContext({user:null,walletId:null,isAuth:!1,loading:!1}),Ge=t=>{const[r,n]=i.exports.useState(""),[o,s]=i.exports.useState(null),[l,h]=i.exports.useState(!1),[m,f]=i.exports.useState(!1);return e(T.Provider,{value:{user:o,setUser:s,walletId:r,setWalletId:n,isAuth:l,setIsAuth:h,loading:m,setLoading:f},children:t.children})};let te;if(window.ethereum)console.log("MetaMask is installed!"),te=new Z(window.ethereum);else{console.log("MetaMask is NOT installed!");const t=new Z.providers.HttpProvider("https://polygon-rpc.com",{chainId:137,name:"matic"});te=new Z(t)}var _e=te;const re=(t,r)=>a(w.Fragment,{children:[e("span",{children:t||""}),e("br",{}),e("span",{children:r||""})]});function We(t){var n;let r=(n=JSON.parse(localStorage.getItem("walletDisabled")))!=null?n:!1;console.log(r),window.ethereum&&(_e.eth.getAccounts().then(o=>{r||t(o[0]||"")}).catch(console.log),window.ethereum.on("accountsChanged",o=>{var l;((l=JSON.parse(localStorage.getItem("walletDisabled")))!=null?l:!1)||t(o[0]||"")}))}async function Ue(t){localStorage.setItem("walletDisabled",!0),t("")}async function Ke(t){if(!window.ethereum){G.error(re("Provider Error","MetaMask is NOT installed!"),{position:G.POSITION.BOTTOM_RIGHT,autoClose:5e3,toastId:"providerError",closeOnClick:!0,pauseOnHover:!1,draggable:!1});return}localStorage.setItem("walletDisabled",!1);try{const r=await window.ethereum.request({method:"eth_requestAccounts"});t(r[0]||"")}catch(r){console.log(r)}}const Je=()=>{const{user:t,setUser:r,isAuth:n,setIsAuth:o,setLoading:s}=i.exports.useContext(T),{walletId:l,setWalletId:h}=i.exports.useContext(T),m=()=>{localStorage.removeItem("token"),o(!1),r(null),s(!1)};return i.exports.useEffect(()=>We(h),[]),e("header",{children:e(ee,{children:a(U,{children:[e(K.LinkContainer,{to:n?"/dashboard":"/",children:e(ee.Brand,{children:e("h2",{children:"DVoting"})})}),e(ee.Toggle,{"aria-controls":"basic-navbar-nav"}),a(_,{className:"ml-auto",children:[t?e(D,{children:a(be,{children:[t.name,e(K.LinkContainer,{to:"#",onClick:m,children:a(_.Link,{children:[e(Ce,{})," Logout"]})})]})}):a(D,{children:[e(K.LinkContainer,{to:"/login",children:a(_.Link,{children:[e(Se,{})," Log In"]})}),e(K.LinkContainer,{to:"/signup",children:a(_.Link,{children:[e(Ie,{})," SignUp"]})})]}),l===""?a(_.Link,{onClick:()=>Ke(h),children:[e(Ne,{size:20})," Connect Wallet"]}):e(ie,{title:l.slice(0,4)+"..."+l.slice(-4),children:e(ie.Item,{onClick:()=>Ue(h),children:"Disconnect"})})]})]})})})},Qe=()=>a("footer",{className:"text-center",children:["\xA9 2022 |"," ",e("a",{href:"https://github.com/DVoting/dvoting.github.io",children:"D-Voting"})]});var Xe="./assets/vote.90a295f2.png";const Ye="_root1_zwkyz_1",Ze="_root2_zwkyz_5",et="_root3_zwkyz_11";var ae={root1:Ye,root2:Ze,root3:et};const tt=()=>a("div",{className:`${ae.root1} d-flex justify-content-evenly align-items-center py-5`,style:{minHeight:"85vh"},children:[a("div",{className:"",style:{maxWidth:"45%"},children:[a("div",{className:"display-4 fw-bold",children:["Empowering India",e("p",{className:"text-info",children:"Through Blockchain"})]}),a("div",{className:"py-5",children:[e("p",{children:"A De-centralized Voting App which addresses the issue of maintaining anonymity of voters on a public blockchain network, achieving lower latency and affordability in the existing models."}),e(N,{variant:"outline-primary",className:"px-4 py-2",href:"/login",children:"Login"}),e(N,{variant:"info",className:"px-4 py-2 mx-5",href:"/signup",children:"Get Started"})]})]}),e("div",{className:"",style:{maxWidth:"30%"},children:e("img",{src:Xe,style:{maxWidth:"100%"}})})]}),ne=[{Icon:ke,title:"Safe and Secure",description:"The casted votes are safely and securely stored in the blockchain database, which mitigates any form of manipulation / tampering like the deletion of legitimate votes or the addition of illegitimate votes."},{Icon:Ee,title:"Accuracy with Transparency",description:"The casting of votes and tallying of the votes would be a lot quicker while also providing better transparency and accuracy."},{Icon:Te,title:"Privacy OP :)",description:"We do not link your Wallet address and your profile identity, thereby keeping your vote anonymous. Also, you can verify that your vote has been recorded or not using the Transaction Id."}],rt=()=>a("div",{className:ae.root2,children:[e("h1",{className:"fw-bold",children:"Notable Features"}),e(ce,{children:ne==null?void 0:ne.map((t,r)=>{const{Icon:n,title:o,description:s}=t;return a(A,{className:"rounded-3 d-flex flex-direction-col justify-content-center align-items-center px-3 py-4 mx-4 my-5",children:[e(n,{size:50,className:"m-3"}),a(A.Body,{className:"px-4",children:[e(A.Title,{className:"fw-bold",children:o}),e(A.Text,{style:{textAlign:"justify"},children:s})]})]},r)})})]}),se=[{Icon:Oe,title:"React"},{Icon:Pe,title:"Node.js"},{Icon:Le,title:"Solidity"},{Icon:De,title:"Web3"},{Icon:Ae,title:"VS Code"}],at=()=>a("div",{className:ae.root3,children:[e("h2",{className:"fw-bold",children:"Tech Stack"}),e(ce,{children:se==null?void 0:se.map((t,r)=>{const{Icon:n,title:o}=t;return a(A,{className:"rounded-pill d-flex flex-direction-col justify-content-center align-items-center mx-4 my-5 shadow-sm",children:[e(n,{size:50,className:"m-3"}),e(A.Body,{className:"",children:e(A.Title,{className:"fw-bold",children:o})})]},r)})})]});var nt="./assets/curve-1.bf7c1ae6.png",st="./assets/curve-2.d369b78c.png",ot="./assets/curve-3.d6a5c9dd.png";const W=({children:t})=>e(U,{children:e(B,{className:"justify-content-md-center",children:e(k,{xs:12,md:6,children:t})})}),M=({variant:t,children:r})=>e($e,{variant:t,children:r});M.defaultProps={variant:"info"};const V=()=>e(He,{animation:"border",role:"status",style:{width:"4vh",height:"4vh",margin:"25vh auto",display:"block",color:"black"}}),lt=()=>{const{isAuth:t,setIsAuth:r,loading:n,setLoading:o}=i.exports.useContext(T),s=j();return w.useEffect(()=>{o(!0),r("token"in localStorage),t&&s("/dashboard",{replace:!0}),o(!1)},[t]),e(D,{children:n?e(V,{}):e(D,{children:a("div",{style:{minHeight:"150vh",width:"100%"},children:[e("img",{src:nt,style:{position:"absolute",right:"0px",maxWidth:"60%",zIndex:"-1"}}),e(tt,{}),e("img",{src:st,style:{position:"absolute",left:"0px",maxWidth:"20%",zIndex:"-1"}}),e(rt,{}),e("img",{src:ot,style:{position:"absolute",right:"0px",maxWidth:"18%",zIndex:"-1"}}),e(at,{}),e(Qe,{})]})})})},z="https://dvoting-server.vercel.app/api",it=async t=>{try{const r={headers:{"Content-Type":"application/json"}},n=await $.post(`${z}/users/login`,t,r);return localStorage.setItem("token",n.data.token),n.data}catch(r){throw r}},ct=async()=>{const t=localStorage.getItem("token"),r={headers:{"Content-type":"application/json",Authorization:`Bearer ${t}`}};try{const{data:n}=await $.get(`${z}/users/profile`,r);return L(P({},n),{error:!1})}catch(n){return console.log(n.response),L(P({},n),{error:!0})}},dt=async t=>{try{const r={headers:{"Content-Type":"application/json"}},n=await $.post(`${z}/users`,t,r);return localStorage.setItem("token",n.data.token),n.data}catch(r){throw r}},ut=async t=>{try{const r=localStorage.getItem("token"),n={headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}},o=await $.put(`${z}/users/verify`,t,n);return localStorage.setItem("token",o.data.token),o.data}catch(r){throw r}},he=async t=>{try{const r={headers:{"Content-Type":"application/json"}};return(await $.put(`${z}/users/profile`,t,r)).data}catch(r){throw r}},ht=()=>{const[t,r]=i.exports.useState(""),[n,o]=i.exports.useState(""),[s,l]=i.exports.useState(!1),h=J(),m=j(),f=h.search?h.search.split("=")[1]:"/",{isAuth:p,setIsAuth:y,loading:d,setLoading:u}=i.exports.useContext(T);return i.exports.useEffect(()=>{y("token"in localStorage),p&&(u(!1),m("/dashboard",{replace:!0}))},[p]),e(D,{children:d?e(V,{}):e(D,{children:e("div",{children:a(W,{children:[e("h1",{children:"Login"}),s&&e(M,{variant:"danger",children:s}),a(c,{onSubmit:async I=>{I.preventDefault(),u(!0);try{await it({email:t,password:n}),y("token"in localStorage)}catch(b){console.log(b),b.response&&b.response.data.message?l(b.response.data.message):l(b.message)}u(!1)},onReset:I=>{I.preventDefault(),r(""),o("")},children:[a(c.Group,{controlId:"email",children:[e(c.Label,{children:"Email Address"}),e(c.Control,{type:"email",placeholder:"Enter email",value:t,required:!0,onChange:I=>{l(!1),r(I.target.value)}})]}),a(c.Group,{controlId:"password",children:[e(c.Label,{children:"Password"}),e(c.Control,{type:"password",placeholder:"Enter password",value:n,required:!0,onChange:I=>{l(!1),o(I.target.value)}})]}),a(B,{className:"py-3",children:[e(k,{children:e(N,{type:"submit",variant:"primary",children:"Sign In"})}),e(k,{children:e(N,{type:"reset",variant:"primary",children:"Reset"})})]}),a(B,{children:[a(k,{children:["New User?"," ",e(H,{to:f?`/signup?redirect=${f}`:"/signup",children:"Register Here"})]}),a(k,{children:["Forgot Password?"," ",e(H,{to:f?`/forgotpassword?redirect=${f}`:"/forgotpassword",children:"Click here"})]})]})]})]})})})})},pt=()=>{const[t,r]=i.exports.useState(""),[n,o]=i.exports.useState(""),[s,l]=i.exports.useState(""),[h,m]=i.exports.useState(""),[f,p]=i.exports.useState("voter"),[y,d]=i.exports.useState(!1),u=J(),x=j(),R=u.search?u.search.split("=")[1]:"/",{isAuth:I,setIsAuth:b,loading:g,setLoading:v}=i.exports.useContext(T);return i.exports.useEffect(()=>{b("token"in localStorage),I&&(v(!1),x("/dashboard",{replace:!0}))},[I]),e(D,{children:g?e(V,{}):e(D,{children:e("div",{children:a(W,{children:[e("h1",{children:"SignUp"}),y&&e(M,{variant:"danger",children:y}),a(c,{onSubmit:async O=>{O.preventDefault(),v(!0);try{await dt({username:n,email:s,password:h,name:t,userType:f}),b("token"in localStorage)}catch(C){console.log(C),C.response&&C.response.data.message?d(C.response.data.message):d(C.message)}v(!1)},onReset:O=>{O.preventDefault(),r(""),o(""),l(""),m(""),p("voter")},children:[a(c.Group,{controlId:"name",children:[e(c.Label,{children:"Name"}),e(c.Control,{type:"text",placeholder:"Enter name",value:t,required:!0,onChange:O=>{d(!1),r(O.target.value)}})]}),a(c.Group,{controlId:"username",children:[e(c.Label,{children:"Username"}),e(c.Control,{type:"text",placeholder:"Enter username",value:n,required:!0,onChange:O=>{d(!1),o(O.target.value)}})]}),a(c.Group,{controlId:"email",children:[e(c.Label,{children:"Email Address"}),e(c.Control,{type:"email",placeholder:"Enter email",value:s,required:!0,onChange:O=>{d(!1),l(O.target.value)}})]}),a(c.Group,{controlId:"password",children:[e(c.Label,{children:"Password"}),e(c.Control,{type:"password",placeholder:"Enter password",value:h,required:!0,onChange:O=>{d(!1),m(O.target.value)}})]}),a(B,{className:"py-3",children:[e(k,{children:e(N,{type:"submit",variant:"primary",children:"Sign Up"})}),e(k,{children:e(N,{type:"reset",variant:"primary",children:"Reset"})})]}),e(B,{children:a(k,{children:["Already registered?"," ",e(H,{to:R?`/login?redirect=${R}`:"/signup",children:"Login Here"})]})})]})]})})})})},mt=async t=>{const r=localStorage.getItem("token"),n={headers:{"Content-type":"application/json",Authorization:`Bearer ${r}`}},o=t._id;try{const{data:s}=await $.get(`${z}/organisers?user=${o}`,n);return L(P({},s),{error:!1})}catch(s){return console.log(s),L(P({},s),{error:!0})}},gt=async t=>{const r=localStorage.getItem("token"),n={headers:{"Content-type":"application/json",Authorization:`Bearer ${r}`}};try{const{data:o}=await $.delete(`${z}/organisers/${t}`,n);return L(P({},o),{error:!1})}catch(o){return console.log(o),L(P({},o),{error:!0})}};async function ft(t){const r=localStorage.getItem("token"),n={headers:{"Content-type":"application/json",Authorization:`Bearer ${r}`}};try{const{data:o}=await $.post(`${z}/organisers`,t,n);return console.log(o),o}catch(o){return console.log(o),L(P({},o.response),{error:!0})}}const yt=t=>{const{show:r,setShow:n,setRedirect:o}=t,[s,l]=w.useState({organisationName:""}),h=p=>{l(L(P({},s),{[p.target.name]:p.target.value}))},m=async p=>{if(p.preventDefault(),!f())return;const y=await ft(s);if(y.error){console.log(y),G.error(re(`error ${y.status}`,`${y.data&&y.data.message||y.statusText}`),{position:G.POSITION.BOTTOM_RIGHT});return}n(!1),o("/org")},f=()=>s.organisationName.length<4?(G.error(re("Organiser Name","must be at least 4 characters long"),{position:G.POSITION.BOTTOM_RIGHT}),!1):!0;return a(q,{size:"lg",show:r,onHide:()=>n(!1),"aria-labelledby":"createOrganiserModal",children:[e(q.Header,{closeButton:!0,children:e(q.Title,{id:"createOrganiserModal",children:"Create Organiser"})}),e(q.Body,{children:a(c,{children:[e(ze,{label:"Organiser name",className:"mb-3",children:e(c.Control,{type:"text",name:"organisationName",value:s.organisationName,onChange:h,required:!0})}),e(N,{className:"text-center",variant:"primary",type:"submit",onClick:m,children:"Create"})]})})]})},vt=async(t,r)=>{const n=localStorage.getItem("token"),o={headers:{"Content-type":"application/json",Authorization:`Bearer ${n}`}},s=L(P({},t),{organiser:r,registrationLink:"https://dvoting.github.io"});console.log(s);try{const{data:l}=await $.post(`${z}/elections`,s,o);return l}catch(l){throw console.log(l),l}};async function Y(t){try{const{data:r}=await $.get(`${z}/elections?${t}`);return console.log(t,r),r.docs}catch(r){return console.log(r),null}}async function wt(t){try{const{data:r}=await $.get(`${z}/voters/${t}`);return console.log(r),r}catch(r){return console.log(r),null}}const xt=()=>{const{user:t,loading:r,setLoading:n}=w.useContext(T),[o,s]=w.useState(!1),[l,h]=w.useState(null),[m,f]=w.useState([]),[p,y]=w.useState([]),[d,u]=w.useState([]),[x,R]=w.useState([]),[I,b]=w.useState(null);return w.useEffect(()=>{n(t===null),console.log(t)},[t]),w.useEffect(async()=>{t&&h(await wt(t.uniqueVoterId))},[t]),w.useEffect(async()=>{if(l&&l.invitations.length>0){const g=`ids=${l.invitations.join(",")}`;f(await Y(g))}},[l]),w.useEffect(async()=>{if(t){const g=`appliedVoter=${t.uniqueVoterId}`;y(await Y(g))}},[t]),w.useEffect(async()=>{if(t){const g=`approvedVoter=${t.uniqueVoterId}`;u(await Y(g))}},[t]),w.useEffect(async()=>{if(t){const g=`appearedVoter=${t.uniqueVoterId}`;R(await Y(g))}},[t]),I?e(Q,{replace:!0,to:I}):e(w.Fragment,{children:r?e(V,{}):e(w.Fragment,{children:e(U,{children:a(B,{children:[a(k,{md:12,lg:4,children:[e(A,{children:t&&a(w.Fragment,{children:[e(A.Header,{children:"User Profile"}),a(S,{variant:"flush",children:[a(S.Item,{children:["Username: ",t.username]}),a(S.Item,{children:["Name: ",t.name]}),a(S.Item,{children:["E-mail: ",t.email," ",t.emailVerified?e("span",{className:"text-success",children:"verified"}):e(H,{to:"/verifyEmail",children:"verify"})]}),a(S.Item,{children:["UVID: ",t.uniqueVoterId]}),l&&a(S.Item,{children:["Wallet:"," ",l.hasWallet?e("span",{className:"text-success",children:"assigned"}):e(H,{to:"#",children:"generate"})]}),e(S.Item,{children:e(H,{to:"/changePassword",children:"Change Password"})})]})]})}),e(A,{style:{marginTop:"5%",marginBottom:"5%"},children:t&&a(S,{variant:"flush",children:[t.userType==="voter"&&a(w.Fragment,{children:[e(S.Item,{onClick:()=>s(!0),style:{cursor:"pointer"},children:"Register an Organisation"}),e(yt,{show:o,setShow:s,setRedirect:b})]}),t.userType==="organiser"&&e(H,{to:"/org",children:e(S.Item,{children:"Manage Organizations"})})]})})]}),e(k,{md:12,lg:8,children:a(A,{children:[e(A.Header,{children:"Elections"}),e(A.Body,{children:l&&a(Re,{defaultActiveKey:"invited",className:"mb-3",children:[e(X,{eventKey:"invited",title:"Invited",children:m.length>0?e(S,{variant:"flush",children:m.map(g=>e(H,{to:"#",children:e(S.Item,{children:g.title})},g._id))}):e(w.Fragment,{children:"Nothing here... "})}),e(X,{eventKey:"approved",title:"Approved",children:d.length>0?e(S,{variant:"flush",children:d.map(g=>e(H,{to:"#",children:e(S.Item,{children:g.title})},g._id))}):e(w.Fragment,{children:"Nothing here... "})}),e(X,{eventKey:"applied",title:"Applied",children:p.length>0?e(S,{variant:"flush",children:p.map(g=>e(H,{to:"#",children:e(S.Item,{children:g.title})},g._id))}):e(w.Fragment,{children:"Nothing here... "})}),e(X,{eventKey:"appeared",title:"Appeared",children:x.length>0?e(S,{variant:"flush",children:x.map(g=>e(H,{to:"#",children:e(S.Item,{children:g.title})},g._id))}):e(w.Fragment,{children:"Nothing here... "})})]})})]})})]})})})})},bt=[{name:"Email not entered",value:"1"},{name:"OTP sent from server",value:"2"},{name:"Change password",value:"3"}],Ct=[{name:"Email not pressed",value:"1"},{name:"OTP sent from server",value:"2"}],pe=async t=>{try{const r={headers:{"Content-Type":"application/json"}};return(await $.put(`${z}/otp`,t,r)).data}catch(r){throw r}},me=async t=>{try{const r={headers:{"Content-Type":"application/json"}};return(await $.patch(`${z}/otp/verify`,t,r)).data}catch(r){throw r}},St=()=>{const{user:t,loading:r,setLoading:n,setUser:o}=i.exports.useContext(T),[s,l]=i.exports.useState("fetching..."),[h,m]=i.exports.useState(""),[f,p]=i.exports.useState(Ct[0].value),[y,d]=i.exports.useState(!1),[u,x]=i.exports.useState(!1),R=j();return i.exports.useEffect(()=>{n(!0),t&&(l(t.email),n(!1),t.emailVerified&&R("/dashboard",{replace:!0}))},[t]),e(D,{children:r?e(V,{}):e("div",{children:a(W,{children:[e("h1",{children:"Verify Email"}),u&&e(M,{variant:"success",children:u}),y&&e(M,{variant:"danger",children:y}),e(c,{onSubmit:async b=>{switch(b.preventDefault(),d(!1),x(!1),f){case"1":n(!0);const g="OTP for e-mail Verification";try{await pe({email:s,purpose:g}),p("2")}catch(v){console.log(v),v.response&&v.response.data.message?d(v.response.data.message):d(v.message)}n(!1);break;case"2":n(!0);try{await me({email:s,otp:h});const v=await ut({email:s});x("Email has been verified"),o(v),R("/dashboard",{replace:!0})}catch(v){console.log(v),v.response&&v.response.data.message?d(v.response.data.message):d(v.message)}n(!1);break}},children:e(B,{className:"py-3",children:a(k,{children:[a(c.Group,{controlId:"email",children:[e(c.Label,{children:"Email Address"}),e(c.Control,{type:"email",placeholder:"Enter your email",value:s,disabled:!0,required:!0})]}),f==="2"&&a(c.Group,{controlId:"otp",children:[e(c.Label,{children:"OTP"}),e(c.Control,{type:"text",placeholder:"Enter OTP received on email",value:h,required:!0,onChange:b=>{d(!1),m(b.target.value)}})]}),e(B,{className:"py-3",children:e(k,{children:e(N,{type:"submit",variant:"primary",children:f=="1"?"Send OTP":"Verify Email"})})})]})})})]})})})},It=()=>{const[t,r]=i.exports.useState("fetching..."),[n,o]=i.exports.useState(""),[s,l]=i.exports.useState(""),[h,m]=i.exports.useState(!1),[f,p]=i.exports.useState(!1),y=j(),{loading:d,user:u,setLoading:x}=i.exports.useContext(T);return i.exports.useEffect(()=>{x(!0),u&&(r(u.email),x(!1))},[u]),e(D,{children:d?e(V,{}):e("div",{children:a(W,{children:[e("h1",{children:"Change Password"}),f&&e(M,{variant:"success",children:f}),h&&e(M,{variant:"danger",children:h}),a(c,{onSubmit:async b=>{if(b.preventDefault(),m(!1),p(!1),n!==s){m("Passwords don't match");return}try{x(!0),await he({email:t,password:n}),x(!1),p("Password changed.. Redirecting to dashboard"),setTimeout(()=>{y("/dashboard",{replace:!0})},[1e3])}catch(g){console.log(g),g.response&&g.response.data.message?m(g.response.data.message):m(g.message)}},onReset:async b=>{b.preventDefault(),o(""),l(""),m(!1),p(!1)},children:[a(c.Group,{controlId:"password",children:[e(c.Label,{children:"Password"}),e(c.Control,{type:"password",placeholder:"Enter new Password",value:n,required:!0,onChange:b=>{m(!1),o(b.target.value)}})]}),a(c.Group,{controlId:"confirmPassword",children:[e(c.Label,{children:"Confirm Password"}),e(c.Control,{type:"password",placeholder:"Confirm your new Password",value:s,required:!0,onChange:b=>{m(!1),l(b.target.value)}})]}),a(B,{className:"py-3",children:[e(k,{children:e(N,{type:"submit",variant:"primary",children:"Change Password"})}),e(k,{children:e(N,{type:"reset",variant:"primary",children:"Reset"})})]})]})]})})})},Nt=t=>{const{isOpen:r,setIsOpen:n,handleDelete:o,_id:s}=t,l=()=>n(!1);return a(q,{show:r,onHide:l,centered:!0,children:[e(q.Header,{closeButton:!0,children:e(q.Title,{children:"Confirm Delete"})}),a(q.Body,{children:[e("p",{children:"Are you sure you want to delete ?"}),e("h4",{children:s})]}),a(q.Footer,{children:[e(N,{variant:"secondary",onClick:l,children:"Cancel"}),e(N,{variant:"danger",onClick:o,children:"Delete"})]})]})},kt=()=>{const[t,r]=i.exports.useState(null),[n,o]=i.exports.useState(!1),[s,l]=i.exports.useState(null),{user:h}=i.exports.useContext(T),m=j();if(i.exports.useEffect(()=>{(async()=>{if(h){const d=await mt(h);if(d.error)return;r(d.docs)}})()},[h,n]),!t)return a("div",{children:[e("h1",{children:"Manage My Organizations"}),e(V,{})]});const f=(d,u)=>{m(`/org/${d}/create-election`,{state:u})},p=d=>{l(d),o(d)},y=async d=>{if(console.log("delete called"),(await gt(d)).error){alert("Some error occured");return}o(!1)};return a("div",{children:[e(Nt,{isOpen:n,setIsOpen:o,_id:s,handleDelete:()=>y(s)}),e("h1",{children:"Manage My Organizations"}),t.length===0?e("h3",{children:"No Organizations found!!"}):e(S,{as:"ol",numbered:!0,className:"",children:t==null?void 0:t.map(d=>{const{organisationName:u,_id:x}=d;return a(S.Item,{as:"li",className:"d-flex flex-row",children:[a(H,{to:`/org/${x}`,style:{textDecoration:"none"},className:"flex-grow-1 px-3",children:[u,a("p",{children:["ID: ",x]})]}),e(N,{className:"align-self-center",onClick:()=>f(x,u),children:"Create Election"}),e("p",{className:"align-self-center text-danger m-3",style:{cursor:"pointer"},onClick:()=>p(x),children:"Delete"})]},x)})})]})},Et=()=>{let r=J().pathname.split("/")[2];return console.log(r),a("div",{children:["Election Details Page",e("h1",{children:r})]})};const Tt=()=>{const t=J();let r=t.pathname.split("/")[2],n=t.state;const[o,s]=i.exports.useState({title:"",openTimestamp:new Date,closeTimestamp:new Date}),[l,h]=i.exports.useState(null),[m,f]=i.exports.useState(null);i.exports.useContext(T);const p=async d=>{d.preventDefault();try{const u=await vt(o,r),{_id:x}=u;h(`/elections/${x}`)}catch(u){console.log(u.response),f(u.response.data)}},y=d=>{d.preventDefault(),h(`/org/${r}`)};return l?e(Q,{to:l,replace:!0}):a("div",{className:"d-flex flex-column justify-content-center align-items-center",style:{height:"70vh"},children:[e("h2",{className:"my-5",children:"Create an Election"}),a(c,{onSubmit:p,onReset:y,className:"bg-light rounded px-4 py-4",style:{background:"pink",minWidth:"40%"},children:[a(c.Group,{className:"my-4",controlId:"electionTitle",children:[e(c.Label,{children:"Title"}),e(c.Control,{type:"text",placeholder:"Enter election title",value:o.title,onChange:d=>{s(u=>L(P({},u),{title:d.target.value}))}})]}),a(c.Group,{className:"my-4",controlId:"organizer",children:[e(c.Label,{children:"Organization Name"}),e(c.Control,{type:"text",value:n,disabled:!0})]}),a("div",{className:"my-4",children:[e("label",{children:"Election Start Time"}),e("br",{}),e(de,{className:"w-100",onChange:d=>{s(u=>L(P({},u),{openTimestamp:d}))},value:o.openTimestamp,minDate:new Date,required:!0})]}),a("div",{className:"my-4",children:[e("label",{children:"Election End Time"}),e("br",{}),e(de,{className:"w-100",onChange:d=>{s(u=>L(P({},u),{closeTimestamp:d}))},value:o.closeTimestamp,minDate:o.openTimestamp})]}),e("br",{}),a("div",{className:"d-flex justify-content-center",children:[e(N,{variant:"secondary",type:"reset",className:"mx-4 px-3",children:"Discard"}),e(N,{variant:"success",type:"submit",className:"mx-4 px-4",children:"Save"})]})]}),m&&e(M,{variant:"danger",children:m})]})},Ot=()=>{const[t,r]=i.exports.useState(""),[n,o]=i.exports.useState(""),[s,l]=i.exports.useState(""),[h,m]=i.exports.useState(""),[f,p]=i.exports.useState(!1),[y,d]=i.exports.useState(!1),[u,x]=i.exports.useState(bt[0].value),R=j(),{isAuth:I,setIsAuth:b,loading:g,setLoading:v}=i.exports.useContext(T);return i.exports.useEffect(()=>{b("token"in localStorage),I&&(v(!1),R("/dashboard",{replace:!0}))},[I]),e(D,{children:g?e(V,{}):e(D,{children:e("div",{children:a(W,{children:[e("h1",{children:"Forgot Password"}),y&&e(M,{variant:"success",children:y}),f&&e(M,{variant:"danger",children:f}),a(c,{onSubmit:async F=>{if(F.preventDefault(),p(!1),d(!1),s!==h){p("Passwords don't match");return}switch(u){case"1":v(!0);const O="OTP for Forgot Password";try{await pe({email:t,purpose:O}),x("2")}catch(C){console.log(C),C.response&&C.response.data.message?p(C.response.data.message):p(C.message)}v(!1);break;case"2":v(!0);try{await me({email:t,otp:n}),x("3")}catch(C){console.log(C),C.response&&C.response.data.message?p(C.response.data.message):p(C.message)}v(!1);break;case"3":v(!0);try{await he({email:t,password:s}),d("Password has been changed")}catch(C){console.log(C),C.response&&C.response.data.message?p(C.response.data.message):p(C.message)}v(!1);break}},children:[(u==="1"||u==="2")&&a(c.Group,{controlId:"email",children:[e(c.Label,{children:"Email Address"}),e(c.Control,{type:"email",placeholder:"Enter your email",value:t,required:!0,onChange:F=>{p(!1),r(F.target.value)}})]}),u==="2"&&a(c.Group,{controlId:"otp",children:[e(c.Label,{children:"OTP"}),e(c.Control,{type:"text",placeholder:"Enter OTP received on email",value:n,required:!0,onChange:F=>{p(!1),o(F.target.value)}})]}),u==="3"&&a(c.Group,{controlId:"password",children:[e(c.Label,{children:"Password"}),e(c.Control,{type:"password",placeholder:"Enter new Password",value:s,required:!0,onChange:F=>{p(!1),l(F.target.value)}})]}),u==="3"&&a(c.Group,{controlId:"confirmPassword",children:[e(c.Label,{children:"Confirm Password"}),e(c.Control,{type:"password",placeholder:"Confirm your new Password",value:h,required:!0,onChange:F=>{p(!1),m(F.target.value)}})]}),e(B,{className:"py-3",children:e(k,{children:e(N,{type:"submit",variant:"primary",children:u=="1"?"Send OTP":u=="2"?"Confirm OTP":"Change Password"})})})]})]})})})})};var Pt="./assets/fourOfour.e2f25f95.jpeg";const Lt=()=>{const{loading:t,isAuth:r,setIsAuth:n}=i.exports.useContext(T);return i.exports.useEffect(()=>{n("token"in localStorage)}),e("div",{children:t?e(V,{}):a(D,{children:[a(H,{to:r?"/dashboard":"/",children:[e(Fe,{}),"Go back to the home page"]}),e("img",{src:Pt})]})})},Dt=()=>{const{user:t,setUser:r,setIsAuth:n,setLoading:o}=i.exports.useContext(T),s=localStorage.getItem("token"),[l,h]=i.exports.useState(!1);return i.exports.useEffect(()=>{(async()=>{if(s&&!t){const m=await ct();m.error?(n(!1),o(!1),h(!0)):(r(m),n(!0))}})()},[s]),l?(localStorage.removeItem("token"),e(Q,{to:"/"})):(console.log("via private route"),s?e(ue,{}):e(Q,{to:"/login"}))},At=()=>(console.log("Organizer route"),e(ue,{})),$t=()=>e("div",{children:"Dummy Route"}),Ht=()=>a(Be,{children:[e("main",{className:"App py-3 bg-gray",children:a(U,{children:[e(Je,{}),a(Me,{children:[e(E,{path:"*",element:e(Lt,{})}),e(E,{exact:!0,path:"/",element:e(lt,{})}),e(E,{path:"/login",element:e(ht,{})}),e(E,{path:"/signup",element:e(pt,{})}),e(E,{path:"/forgotpassword",element:e(Ot,{})}),a(E,{path:"/",element:e(Dt,{}),children:[e(E,{exact:!0,path:"/dashboard",element:e(xt,{})}),e(E,{exact:!0,path:"/elections/:id",element:e(Et,{})}),e(E,{exact:!0,path:"/verifyEmail",element:e(St,{})}),e(E,{exact:!0,path:"/changePassword",element:e(It,{})}),a(E,{path:"/org",element:e(At,{}),children:[e(E,{path:"/org",element:e(kt,{})}),e(E,{path:"/org/:id",element:e($t,{})}),e(E,{path:"/org/:id/create-election",element:e(Tt,{})})]})]})]})]})}),e(qe,{style:{width:"25em"}})]});Ve.render(e(Ge,{children:e(Ht,{})}),document.getElementById("root"));
