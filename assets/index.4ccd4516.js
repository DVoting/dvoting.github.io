var Ee=Object.defineProperty,Oe=Object.defineProperties;var Pe=Object.getOwnPropertyDescriptors;var me=Object.getOwnPropertySymbols;var Ae=Object.prototype.hasOwnProperty,De=Object.prototype.propertyIsEnumerable;var ge=(t,r,n)=>r in t?Ee(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,D=(t,r)=>{for(var n in r||(r={}))Ae.call(r,n)&&ge(t,n,r[n]);if(me)for(var n of me(r))De.call(r,n)&&ge(t,n,r[n]);return t},L=(t,r)=>Oe(t,Pe(r));import{r as i,j as e,W as le,a,R as v,t as B,N as ie,C as X,b as ae,c as ee,F as z,d as Le,e as $e,f as Me,V as Be,B as He,g as fe,h as N,i as ye,k as _,A as ze,l as Re,M as Ge,m as _e,n as Fe,S as je,o as qe,p as We,q,s as $,u as Ve,v as Ue,w as U,x as P,y as Q,z as l,L as F,D as K,E as ve,G as te,H as E,T as Ke,I as ne,P as we,J as xe,K as be,O as Ye,Q as Je,U as Xe,X as se,Y as Qe,Z as Ce,_ as Ze,$ as et,a0 as H,a1 as tt,a2 as rt}from"./vendor.817745f5.js";const at=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function n(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerpolicy&&(c.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?c.credentials="include":o.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(o){if(o.ep)return;o.ep=!0;const c=n(o);fetch(o.href,c)}};at();const M=i.exports.createContext({user:null,walletId:null,isAuth:!1,loading:!1}),nt=t=>{const[r,n]=i.exports.useState(""),[s,o]=i.exports.useState(80001),[c,h]=i.exports.useState(null),[u,x]=i.exports.useState(!1),[p,f]=i.exports.useState(!1);return e(M.Provider,{value:{user:c,setUser:h,walletId:r,setWalletId:n,isAuth:u,setIsAuth:x,loading:p,setLoading:f,chainId:s,setChainId:o},children:t.children})};let ce;if(window.ethereum)console.log("MetaMask is installed!"),ce=new le(window.ethereum);else{console.log("MetaMask is NOT installed!");const t="https://speedy-nodes-nyc.moralis.io/2aa1ce4616e3c936bfbb33b8/polygon/mumbai",r=new le.providers.HttpProvider(t,{chainId:80001,name:"Mumbai"});ce=new le(r)}var Y=ce;const J=(t,r)=>a(v.Fragment,{children:[e("span",{children:t||""}),e("br",{}),e("span",{children:r||""})]}),st={1:"Ethereum Main Network",2:"Expanse Network",3:"Ropsten Test Network",4:"Rinkeby Test Network",5:"Goerli Test Network",42:"Kovan Test Network",56:"BSC Main Network",97:"BSC Test Network",43114:"Avalanche Main C-Chain",43113:"Avalanche FUJI C-Chain",137:"Polygon Main Network",80001:"Mumbai Test Network"},Ie=t=>st[t]||`Unknown Network (${t})`;async function ot(t,r){var o;let n=(o=JSON.parse(localStorage.getItem("walletDisabled")))!=null?o:!1;console.log(n);let s=await Y.eth.getChainId();r(s),window.ethereum&&(Y.eth.getAccounts().then(c=>{n||t(c[0]||"")}).catch(console.log),window.ethereum.on("accountsChanged",c=>{var u;((u=JSON.parse(localStorage.getItem("walletDisabled")))!=null?u:!1)||t(c[0]||"")}),window.ethereum.on("chainChanged",async()=>{s=await Y.eth.getChainId(),r(s)}))}async function lt(t){localStorage.setItem("walletDisabled",!0),t("")}async function it(t){if(!window.ethereum){B.error(J("Provider Error","MetaMask is NOT installed!"),{position:B.POSITION.BOTTOM_RIGHT,autoClose:5e3,toastId:"providerError",closeOnClick:!0,pauseOnHover:!1,draggable:!1});return}localStorage.setItem("walletDisabled",!1);try{const r=await window.ethereum.request({method:"eth_requestAccounts"});t(r[0]||"")}catch(r){console.log(r)}}async function ct(t){console.log(t);let[r]=await Y.eth.getAccounts();try{return await Y.eth.personal.sign(Y.utils.keccak256(t),r,null)}catch(n){return B.error(J(n.message.split(":")[0],n.message.split(":")[1]),{position:B.POSITION.BOTTOM_RIGHT,autoClose:5e3,toastId:"signatureError",closeOnClick:!0,pauseOnHover:!1,draggable:!1}),null}}const dt=()=>{const{user:t,setUser:r,isAuth:n,setIsAuth:s,setLoading:o}=i.exports.useContext(M),{walletId:c,setWalletId:h}=i.exports.useContext(M),{chainId:u,setChainId:x}=i.exports.useContext(M),p=()=>{localStorage.removeItem("token"),s(!1),r(null),o(!1)};return i.exports.useEffect(async()=>{await ot(h,x)},[]),e("header",{children:e(ie,{children:a(X,{children:[e(ae.LinkContainer,{to:n?"/dashboard":"/",children:e(ie.Brand,{children:e("h2",{children:"DVoting"})})}),e(ie.Toggle,{"aria-controls":"basic-navbar-nav"}),a(ee,{className:"ml-auto",children:[t?e(z,{children:a(Le,{children:[t.name,e(ae.LinkContainer,{to:"#",onClick:p,children:a(ee.Link,{children:[e($e,{})," Logout"]})})]})}):a(z,{children:[e(ae.LinkContainer,{to:"/login",children:a(ee.Link,{children:[e(Me,{})," Log In"]})}),e(ae.LinkContainer,{to:"/signup",children:a(ee.Link,{children:[e(Be,{})," SignUp"]})})]}),c===""?a(ee.Link,{onClick:()=>it(h),children:[e(He,{size:20})," Connect Wallet"]}):e(fe,{title:c.slice(0,4)+"..."+c.slice(-4),children:e(fe.Item,{onClick:()=>lt(h),children:"Disconnect"})})]})]})})})},ut=()=>a("footer",{className:"text-center",children:["\xA9 2022 |"," ",e("a",{href:"https://github.com/DVoting/dvoting.github.io",children:"D-Voting"})]});var ht="./assets/vote.90a295f2.png";const pt="_root1_zwkyz_1",mt="_root2_zwkyz_5",gt="_root3_zwkyz_11";var de={root1:pt,root2:mt,root3:gt};const ft=()=>a("div",{className:`${de.root1} d-flex justify-content-evenly align-items-center py-5`,style:{minHeight:"85vh"},children:[a("div",{className:"",style:{maxWidth:"45%"},children:[a("div",{className:"display-4 fw-bold",children:["Empowering India",e("p",{className:"text-info",children:"Through Blockchain"})]}),a("div",{className:"py-5",children:[e("p",{children:"A De-centralized Voting App which addresses the issue of maintaining anonymity of voters on a public blockchain network, achieving lower latency and affordability in the existing models."}),e(N,{variant:"outline-primary",className:"px-4 py-2",href:"/login",children:"Login"}),e(N,{variant:"info",className:"px-4 py-2 mx-5",href:"/signup",children:"Get Started"})]})]}),e("div",{className:"",style:{maxWidth:"30%"},children:e("img",{src:ht,style:{maxWidth:"100%"}})})]}),ue=[{Icon:ze,title:"Safe and Secure",description:"The casted votes are safely and securely stored in the blockchain database, which mitigates any form of manipulation / tampering like the deletion of legitimate votes or the addition of illegitimate votes."},{Icon:Re,title:"Accuracy with Transparency",description:"The casting of votes and tallying of the votes would be a lot quicker while also providing better transparency and accuracy."},{Icon:Ge,title:"Privacy OP :)",description:"We do not link your Wallet address and your profile identity, thereby keeping your vote anonymous. Also, you can verify that your vote has been recorded or not using the Transaction Id."}],yt=()=>a("div",{className:de.root2,children:[e("h1",{className:"fw-bold",children:"Notable Features"}),e(ye,{children:ue==null?void 0:ue.map((t,r)=>{const{Icon:n,title:s,description:o}=t;return a(_,{className:"rounded-3 d-flex flex-direction-col justify-content-center align-items-center px-3 py-4 mx-4 my-5",children:[e(n,{size:50,className:"m-3"}),a(_.Body,{className:"px-4",children:[e(_.Title,{className:"fw-bold",children:s}),e(_.Text,{style:{textAlign:"justify"},children:o})]})]},r)})})]}),he=[{Icon:_e,title:"React"},{Icon:Fe,title:"Node.js"},{Icon:je,title:"Solidity"},{Icon:qe,title:"Web3"},{Icon:We,title:"VS Code"}],vt=()=>a("div",{className:de.root3,children:[e("h2",{className:"fw-bold",children:"Tech Stack"}),e(ye,{children:he==null?void 0:he.map((t,r)=>{const{Icon:n,title:s}=t;return a(_,{className:"rounded-pill d-flex flex-direction-col justify-content-center align-items-center mx-4 my-5 shadow-sm",children:[e(n,{size:50,className:"m-3"}),e(_.Body,{className:"",children:e(_.Title,{className:"fw-bold",children:s})})]},r)})})]});var wt="./assets/curve-1.bf7c1ae6.png",xt="./assets/curve-2.d369b78c.png",bt="./assets/curve-3.d6a5c9dd.png";const re=({children:t})=>e(X,{children:e(q,{className:"justify-content-md-center",children:e($,{xs:12,md:6,children:t})})}),W=({variant:t,children:r})=>e(Ve,{variant:t,children:r});W.defaultProps={variant:"info"};const V=()=>e(Ue,{animation:"border",role:"status",style:{width:"4vh",height:"4vh",margin:"25vh auto",display:"block",color:"black"}}),Ct=()=>{const{isAuth:t,setIsAuth:r,loading:n,setLoading:s}=i.exports.useContext(M),o=U();return v.useEffect(()=>{s(!0),r("token"in localStorage),t&&o("/dashboard",{replace:!0}),s(!1)},[t]),e(z,{children:n?e(V,{}):e(z,{children:a("div",{style:{minHeight:"150vh",width:"100%"},children:[e("img",{src:wt,style:{position:"absolute",right:"0px",maxWidth:"60%",zIndex:"-1"}}),e(ft,{}),e("img",{src:xt,style:{position:"absolute",left:"0px",maxWidth:"20%",zIndex:"-1"}}),e(yt,{}),e("img",{src:bt,style:{position:"absolute",right:"0px",maxWidth:"18%",zIndex:"-1"}}),e(vt,{}),e(ut,{})]})})})},A="https://dvoting-server.vercel.app/api",It=async t=>{try{const r={headers:{"Content-Type":"application/json"}},n=await P.post(`${A}/users/login`,t,r);return localStorage.setItem("token",n.data.token),n.data}catch(r){throw r}},St=async()=>{const t=localStorage.getItem("token"),r={headers:{"Content-type":"application/json",Authorization:`Bearer ${t}`}};try{const{data:n}=await P.get(`${A}/users/profile`,r);return L(D({},n),{error:!1})}catch(n){return console.log(n.response),L(D({},n),{error:!0})}},Nt=async t=>{try{const r={headers:{"Content-Type":"application/json"}},n=await P.post(`${A}/users`,t,r);return localStorage.setItem("token",n.data.token),n.data}catch(r){throw r}},kt=async t=>{try{const r=localStorage.getItem("token"),n={headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}},s=await P.put(`${A}/users/verify`,t,n);return localStorage.setItem("token",s.data.token),s.data}catch(r){throw r}},Se=async t=>{try{const r={headers:{"Content-Type":"application/json"}};return(await P.put(`${A}/users/profile`,t,r)).data}catch(r){throw r}},Tt=()=>{const[t,r]=i.exports.useState(""),[n,s]=i.exports.useState(""),[o,c]=i.exports.useState(!1),h=Q(),u=U(),x=h.search?h.search.split("=")[1]:"/",{isAuth:p,setIsAuth:f,loading:d,setLoading:m}=i.exports.useContext(M);return i.exports.useEffect(()=>{f("token"in localStorage),p&&(m(!1),u("/dashboard",{replace:!0}))},[p]),e(z,{children:d?e(V,{}):e(z,{children:e("div",{children:a(re,{children:[e("h1",{children:"Login"}),o&&e(W,{variant:"danger",children:o}),a(l,{onSubmit:async k=>{k.preventDefault(),m(!0);try{await It({email:t,password:n}),f("token"in localStorage)}catch(S){console.log(S),S.response&&S.response.data.message?c(S.response.data.message):c(S.message)}m(!1)},onReset:k=>{k.preventDefault(),r(""),s("")},children:[a(l.Group,{controlId:"email",children:[e(l.Label,{children:"Email Address"}),e(l.Control,{type:"email",placeholder:"Enter email",value:t,required:!0,onChange:k=>{c(!1),r(k.target.value)}})]}),a(l.Group,{controlId:"password",children:[e(l.Label,{children:"Password"}),e(l.Control,{type:"password",placeholder:"Enter password",value:n,required:!0,onChange:k=>{c(!1),s(k.target.value)}})]}),a(q,{className:"py-3",children:[e($,{children:e(N,{type:"submit",variant:"primary",children:"Sign In"})}),e($,{children:e(N,{type:"reset",variant:"primary",children:"Reset"})})]}),a(q,{children:[a($,{children:["New User?"," ",e(F,{to:x?`/signup?redirect=${x}`:"/signup",children:"Register Here"})]}),a($,{children:["Forgot Password?"," ",e(F,{to:x?`/forgotpassword?redirect=${x}`:"/forgotpassword",children:"Click here"})]})]})]})]})})})})},Et=()=>{const[t,r]=i.exports.useState(""),[n,s]=i.exports.useState(""),[o,c]=i.exports.useState(""),[h,u]=i.exports.useState(""),[x,p]=i.exports.useState("voter"),[f,d]=i.exports.useState(!1),m=Q(),b=U(),T=m.search?m.search.split("=")[1]:"/",{isAuth:k,setIsAuth:S,loading:y,setLoading:I}=i.exports.useContext(M);return i.exports.useEffect(()=>{S("token"in localStorage),k&&(I(!1),b("/dashboard",{replace:!0}))},[k]),e(z,{children:y?e(V,{}):e(z,{children:e("div",{children:a(re,{children:[e("h1",{children:"SignUp"}),f&&e(W,{variant:"danger",children:f}),a(l,{onSubmit:async C=>{C.preventDefault(),I(!0);try{await Nt({username:n,email:o,password:h,name:t,userType:x}),S("token"in localStorage)}catch(w){console.log(w),w.response&&w.response.data.message?d(w.response.data.message):d(w.message)}I(!1)},onReset:C=>{C.preventDefault(),r(""),s(""),c(""),u(""),p("voter")},children:[a(l.Group,{controlId:"name",children:[e(l.Label,{children:"Name"}),e(l.Control,{type:"text",placeholder:"Enter name",value:t,required:!0,onChange:C=>{d(!1),r(C.target.value)}})]}),a(l.Group,{controlId:"username",children:[e(l.Label,{children:"Username"}),e(l.Control,{type:"text",placeholder:"Enter username",value:n,required:!0,onChange:C=>{d(!1),s(C.target.value)}})]}),a(l.Group,{controlId:"email",children:[e(l.Label,{children:"Email Address"}),e(l.Control,{type:"email",placeholder:"Enter email",value:o,required:!0,onChange:C=>{d(!1),c(C.target.value)}})]}),a(l.Group,{controlId:"password",children:[e(l.Label,{children:"Password"}),e(l.Control,{type:"password",placeholder:"Enter password",value:h,required:!0,onChange:C=>{d(!1),u(C.target.value)}})]}),a(q,{className:"py-3",children:[e($,{children:e(N,{type:"submit",variant:"primary",children:"Sign Up"})}),e($,{children:e(N,{type:"reset",variant:"primary",children:"Reset"})})]}),e(q,{children:a($,{children:["Already registered?"," ",e(F,{to:T?`/login?redirect=${T}`:"/signup",children:"Login Here"})]})})]})]})})})})},Ot=async t=>{const r=localStorage.getItem("token"),n={headers:{"Content-type":"application/json",Authorization:`Bearer ${r}`}},s=t._id;try{const{data:o}=await P.get(`${A}/organisers?user=${s}`,n);return L(D({},o),{error:!1})}catch(o){return console.log(o),L(D({},o),{error:!0})}},Pt=async t=>{const r=localStorage.getItem("token"),n={headers:{"Content-type":"application/json",Authorization:`Bearer ${r}`}};try{const{data:s}=await P.delete(`${A}/organisers/${t}`,n);return L(D({},s),{error:!1})}catch(s){return console.log(s),L(D({},s),{error:!0})}};async function At(t){const r=localStorage.getItem("token"),n={headers:{"Content-type":"application/json",Authorization:`Bearer ${r}`}};try{const{data:s}=await P.post(`${A}/organisers`,t,n);return console.log(s),s}catch(s){return console.log(s),L(D({},s.response),{error:!0})}}const Dt=t=>{const{show:r,setShow:n,setRedirect:s}=t,[o,c]=v.useState({organisationName:""}),h=p=>{c(L(D({},o),{[p.target.name]:p.target.value}))},u=async p=>{if(p.preventDefault(),!x())return;const f=await At(o);if(f.error){console.log(f),B.error(J(`error ${f.status}`,`${f.data&&f.data.message||f.statusText}`),{position:B.POSITION.BOTTOM_RIGHT});return}n(!1),s("/org")},x=()=>o.organisationName.length<4?(B.error(J("Organiser Name","must be at least 4 characters long"),{position:B.POSITION.BOTTOM_RIGHT}),!1):!0;return a(K,{size:"lg",show:r,onHide:()=>n(!1),"aria-labelledby":"createOrganiserModal",children:[e(K.Header,{closeButton:!0,children:e(K.Title,{id:"createOrganiserModal",children:"Create Organiser"})}),e(K.Body,{children:a(l,{children:[e(ve,{label:"Organiser name",className:"mb-3",children:e(l.Control,{type:"text",name:"organisationName",value:o.organisationName,onChange:h,required:!0})}),e(N,{className:"text-center",variant:"primary",type:"submit",onClick:u,children:"Create"})]})})]})},Lt=async(t,r)=>{const n=localStorage.getItem("token"),s={headers:{"Content-type":"application/json",Authorization:`Bearer ${n}`}},o=L(D({},t),{organiser:r,registrationLink:"https://dvoting.github.io"});try{const{data:c}=await P.post(`${A}/elections`,o,s);return c}catch(c){throw c}};async function oe(t){try{const{data:r}=await P.get(`${A}/elections?${t}`);return r.docs}catch(r){return console.log(r),null}}async function $t(t,r){const n=localStorage.getItem("token"),s={headers:{"Content-type":"application/json",Authorization:`Bearer ${n}`}};try{const{data:o}=await P.put(`${A}/elections/${t}`,r,s);return o}catch(o){throw o}}async function Mt(t){try{const{data:r}=await P.get(`${A}/elections/${t}`),{closeTimestamp:n,openTimestamp:s,organiser:o,title:c,registrationLink:h,deploymentAddress:u}=r;return{closeTimestamp:n,openTimestamp:s,organiser:o,title:c,registrationLink:h,deploymentAddress:u}}catch(r){return L(D({},r),{error:!0})}}async function pe(t){try{const{data:r}=await P.get(`${A}/elections/${t}/candidates`);return r}catch(r){console.log(r)}}async function Bt(t,r){const n=localStorage.getItem("token"),s={headers:{"Content-type":"application/json",Authorization:`Bearer ${n}`}};try{const{data:o}=await P.post(`${A}/elections/${t}/candidates`,r,s);return o}catch(o){throw o}}async function Ht(t,r){const n=localStorage.getItem("token"),s={headers:{"Content-type":"application/json",Authorization:`Bearer ${n}`}};try{const{data:o}=await P.delete(`${A}/elections/${t}/candidates/${r}`,s);return o}catch(o){throw o}}async function zt(t){const r=localStorage.getItem("token"),n={headers:{"Content-type":"application/json",Authorization:`Bearer ${r}`}};try{const{data:s}=await P.patch(`${A}/elections/${t}/deploy`,{},n);return s}catch(s){throw s}}async function Ne(t){try{const{data:r}=await P.get(`${A}/voters/${t}`);return console.log(r),r}catch(r){return console.log(r),null}}async function Rt(t){const r=localStorage.getItem("token"),n={headers:{"Content-type":"application/json",Authorization:`Bearer ${r}`}};try{const{data:s}=await P.patch(`${A}/voters/wallet`,t,n);return console.log(s),s}catch(s){return console.log(s),L(D({},s.response),{error:!0})}}const Gt=()=>{const{user:t,loading:r,setLoading:n}=v.useContext(M),[s,o]=v.useState(!1),[c,h]=v.useState(null),[u,x]=v.useState([]),[p,f]=v.useState([]),[d,m]=v.useState([]),[b,T]=v.useState([]),[k,S]=v.useState(null);return v.useEffect(()=>{n(t===null),console.log(t)},[t]),v.useEffect(async()=>{t&&h(await Ne(t.uniqueVoterId))},[t]),v.useEffect(async()=>{if(c&&c.invitations.length>0){const y=`ids=${c.invitations.join(",")}`;x(await oe(y))}},[c]),v.useEffect(async()=>{if(t){const y=`appliedVoter=${t.uniqueVoterId}`;f(await oe(y))}},[t]),v.useEffect(async()=>{if(t){const y=`approvedVoter=${t.uniqueVoterId}`;m(await oe(y))}},[t]),v.useEffect(async()=>{if(t){const y=`appearedVoter=${t.uniqueVoterId}`;T(await oe(y))}},[t]),k?e(te,{replace:!0,to:k}):r?e(V,{}):e(v.Fragment,{children:e(X,{children:a(q,{children:[a($,{md:12,lg:4,children:[e(_,{children:t&&a(v.Fragment,{children:[e(_.Header,{children:"User Profile"}),a(E,{variant:"flush",children:[a(E.Item,{children:["Username: ",t.username]}),a(E.Item,{children:["Name: ",t.name]}),a(E.Item,{children:["E-mail: ",t.email," ",t.emailVerified?e("span",{className:"text-success",children:"verified"}):e(F,{to:"/verifyEmail",children:"verify"})]}),a(E.Item,{children:["UVID: ",t.uniqueVoterId]}),c&&a(E.Item,{children:["Wallet:"," ",c.hasWallet?a(v.Fragment,{children:[e("span",{className:"text-success",children:"assigned"})," | ","Nonce: #",c.nonce]}):e(F,{to:"wallet",children:"generate"})]}),e(E.Item,{children:e(F,{to:"/changePassword",children:"Change Password"})})]})]})}),e(_,{style:{marginTop:"5%",marginBottom:"5%"},children:t&&a(E,{variant:"flush",children:[t.userType==="voter"&&a(v.Fragment,{children:[e(E.Item,{onClick:()=>o(!0),style:{cursor:"pointer"},children:"Register an Organisation"}),e(Dt,{show:s,setShow:o,setRedirect:S})]}),t.userType==="organiser"&&e(F,{to:"/org",children:e(E.Item,{children:"Manage Organizations"})})]})})]}),e($,{md:12,lg:8,children:a(_,{children:[e(_.Header,{children:"Elections"}),e(_.Body,{children:c&&a(Ke,{defaultActiveKey:"invited",className:"mb-3",children:[e(ne,{eventKey:"invited",title:"Invited",children:u.length>0?e(E,{variant:"flush",children:u.map(y=>e(F,{to:"#",children:e(E.Item,{children:y.title})},y._id))}):e(v.Fragment,{children:"Nothing here... "})}),e(ne,{eventKey:"approved",title:"Approved",children:d.length>0?e(E,{variant:"flush",children:d.map(y=>e(F,{to:"#",children:e(E.Item,{children:y.title})},y._id))}):e(v.Fragment,{children:"Nothing here... "})}),e(ne,{eventKey:"applied",title:"Applied",children:p.length>0?e(E,{variant:"flush",children:p.map(y=>e(F,{to:"#",children:e(E.Item,{children:y.title})},y._id))}):e(v.Fragment,{children:"Nothing here... "})}),e(ne,{eventKey:"appeared",title:"Appeared",children:b.length>0?e(E,{variant:"flush",children:b.map(y=>e(F,{to:"#",children:e(E.Item,{children:y.title})},y._id))}):e(v.Fragment,{children:"Nothing here... "})})]})})]})})]})})})},_t=()=>{const{loading:t,setLoading:r,user:n}=v.useContext(M),{walletId:s,setWalletId:o}=i.exports.useContext(M),[c,h]=v.useState(null),[u,x]=v.useState(null),[p,f]=v.useState(""),[d,m]=v.useState(null),[b,T]=v.useState(null),[k,S]=v.useState(0),[y,I]=v.useState(!1);v.useEffect(()=>{let j="0",R=!1;document.addEventListener("mousemove",O=>{R=!0;let G=Math.sqrt(O.offsetX*O.offsetX+O.offsetY*O.offsetY);G=Math.round(G)*17%16,j=G.toString(16)}),setInterval(()=>{R=!1},200),setInterval(()=>{f(O=>(k<100&&S(Math.round(O.length/64*100)),O.length<64&&R?O+j:O))},100)},[]),v.useEffect(()=>{r(!n||!u),u&&u.hasWallet&&h("/dashboard"),console.log(n)},[n,u]),v.useEffect(async()=>{n&&x(await Ne(n.uniqueVoterId))},[n]);const Z=()=>{if(d)return;let j="";for(let O of p){let G=parseInt(O,16);G=G^Math.floor(Math.random()*16),j+=G.toString(16)}m(j);let R=Y.eth.accounts.privateKeyToAccount(j);T(R.address),console.log(R)},g=async(j,R=null)=>{await navigator.clipboard.writeText(j),B.info(J(R,"copied to clipboard"),{position:B.POSITION.BOTTOM_CENTER,autoClose:500,hideProgressBar:!0,toastId:"copyToast"})},C=(j,R)=>{let O=document.createElement("a");O.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(R)),O.setAttribute("download",j),O.style.display="none",document.body.appendChild(O),O.click(),document.body.removeChild(O)},w=async()=>{if(!s){B.error(J("No wallet connected",null),{position:B.POSITION.BOTTOM_RIGHT,autoClose:5e3,toastId:"walletError",closeOnClick:!0,pauseOnHover:!1,draggable:!1});return}let j=JSON.stringify({voter:u._id,address:Y.utils.toChecksumAddress(s)}),R=await ct(j);if(!R)return;let O={address:Y.utils.toChecksumAddress(s),signature:R};const G=await Rt(O);if(G.error){console.log(G),B.error(J(`error ${G.status}`,`${G.data||G.statusText}`),{position:B.POSITION.BOTTOM_RIGHT});return}B.success(J("Approved Wallet",`${b}`),{position:B.POSITION.BOTTOM_RIGHT}),h("/dashboard")};return c?e(te,{replace:!0,to:c}):t?e(V,{}):e(v.Fragment,{children:e(X,{children:a(q,{children:[e($,{md:12,lg:2}),a($,{md:12,lg:8,children:[a("p",{children:["Generating Ethereum Wallet...",e("br",{}),"MOVE your mouse around to add some extra randomness..."]}),a(l,{children:[a(ve,{label:"Randomness",className:"mb-3",children:[e(l.Control,{as:"textarea",value:p,disabled:!0,style:{resize:"none",height:"5rem"}}),k===100?e(we,{variant:"success",now:100,label:"Done"}):e(we,{now:k,label:`${k}%`})]}),e("div",{className:"d-grid gap-2",children:e(N,{variant:"primary",onClick:()=>Z(),disabled:k!==100,children:"Generate Ethereum Wallet"})})]}),e("hr",{}),b&&a(l,{children:[a(l.Group,{className:"mb-3",children:[e(l.Label,{children:"Ethereum address"}),a(xe,{children:[e(l.Control,{type:"text",value:b,onChange:()=>{}}),e(N,{variant:"light",onClick:()=>g(b,"Address"),children:e(be,{})})]})]}),a(l.Group,{className:"mb-3",children:[e(l.Label,{children:"Private key"}),a(xe,{children:[e(l.Control,{type:y?"text":"password",value:d,onChange:()=>{}}),e(N,{variant:"light",onClick:()=>I(!y),children:y?e(Ye,{size:20}):e(Je,{size:20})}),e(N,{variant:"light",onClick:()=>g(d,"Private key"),children:e(be,{})}),e(N,{variant:"light",onClick:()=>C("key.txt",d),children:e(Xe,{})})]})]}),e("hr",{}),e(l.Group,{className:"mb-3",children:s.toLowerCase()===b.toLowerCase()?e(N,{variant:"primary",onClick:async()=>{await w()},children:"Approve Wallet"}):a("p",{className:"alert alert-info",children:["Before proceeding, connect the above wallet by importing it's private key."," ",e("a",{href:"https://metamask.zendesk.com/hc/en-us/articles/360015489331-How-to-import-an-Account",target:"_blank",rel:"noreferrer",children:"steps"})]})})]})]}),e($,{md:12,lg:2})]})})})},Ft=[{name:"Email not entered",value:"1"},{name:"OTP sent from server",value:"2"},{name:"Change password",value:"3"}],jt=[{name:"Email not pressed",value:"1"},{name:"OTP sent from server",value:"2"}],ke=async t=>{try{const r={headers:{"Content-Type":"application/json"}};return(await P.put(`${A}/otp`,t,r)).data}catch(r){throw r}},Te=async t=>{try{const r={headers:{"Content-Type":"application/json"}};return(await P.patch(`${A}/otp/verify`,t,r)).data}catch(r){throw r}},qt=()=>{const{user:t,loading:r,setLoading:n,setUser:s}=i.exports.useContext(M),[o,c]=i.exports.useState("fetching..."),[h,u]=i.exports.useState(""),[x,p]=i.exports.useState(jt[0].value),[f,d]=i.exports.useState(!1),[m,b]=i.exports.useState(!1),T=U();return i.exports.useEffect(()=>{n(!0),t&&(c(t.email),n(!1),t.emailVerified&&T("/dashboard",{replace:!0}))},[t]),e(z,{children:r?e(V,{}):e("div",{children:a(re,{children:[e("h1",{children:"Verify Email"}),m&&e(W,{variant:"success",children:m}),f&&e(W,{variant:"danger",children:f}),e(l,{onSubmit:async S=>{switch(S.preventDefault(),d(!1),b(!1),x){case"1":n(!0);const y="OTP for e-mail Verification";try{await ke({email:o,purpose:y}),p("2")}catch(I){console.log(I),I.response&&I.response.data.message?d(I.response.data.message):d(I.message)}n(!1);break;case"2":n(!0);try{await Te({email:o,otp:h});const I=await kt({email:o});b("Email has been verified"),s(I),T("/dashboard",{replace:!0})}catch(I){console.log(I),I.response&&I.response.data.message?d(I.response.data.message):d(I.message)}n(!1);break}},children:e(q,{className:"py-3",children:a($,{children:[a(l.Group,{controlId:"email",children:[e(l.Label,{children:"Email Address"}),e(l.Control,{type:"email",placeholder:"Enter your email",value:o,disabled:!0,required:!0})]}),x==="2"&&a(l.Group,{controlId:"otp",children:[e(l.Label,{children:"OTP"}),e(l.Control,{type:"text",placeholder:"Enter OTP received on email",value:h,required:!0,onChange:S=>{d(!1),u(S.target.value)}})]}),e(q,{className:"py-3",children:e($,{children:e(N,{type:"submit",variant:"primary",children:x=="1"?"Send OTP":"Verify Email"})})})]})})})]})})})},Wt=()=>{const[t,r]=i.exports.useState("fetching..."),[n,s]=i.exports.useState(""),[o,c]=i.exports.useState(""),[h,u]=i.exports.useState(!1),[x,p]=i.exports.useState(!1),f=U(),{loading:d,user:m,setLoading:b}=i.exports.useContext(M);return i.exports.useEffect(()=>{b(!0),m&&(r(m.email),b(!1))},[m]),e(z,{children:d?e(V,{}):e("div",{children:a(re,{children:[e("h1",{children:"Change Password"}),x&&e(W,{variant:"success",children:x}),h&&e(W,{variant:"danger",children:h}),a(l,{onSubmit:async S=>{if(S.preventDefault(),u(!1),p(!1),n!==o){u("Passwords don't match");return}try{b(!0),await Se({email:t,password:n}),b(!1),p("Password changed.. Redirecting to dashboard"),setTimeout(()=>{f("/dashboard",{replace:!0})},[1e3])}catch(y){console.log(y),y.response&&y.response.data.message?u(y.response.data.message):u(y.message)}},onReset:async S=>{S.preventDefault(),s(""),c(""),u(!1),p(!1)},children:[a(l.Group,{controlId:"password",children:[e(l.Label,{children:"Password"}),e(l.Control,{type:"password",placeholder:"Enter new Password",value:n,required:!0,onChange:S=>{u(!1),s(S.target.value)}})]}),a(l.Group,{controlId:"confirmPassword",children:[e(l.Label,{children:"Confirm Password"}),e(l.Control,{type:"password",placeholder:"Confirm your new Password",value:o,required:!0,onChange:S=>{u(!1),c(S.target.value)}})]}),a(q,{className:"py-3",children:[e($,{children:e(N,{type:"submit",variant:"primary",children:"Change Password"})}),e($,{children:e(N,{type:"reset",variant:"primary",children:"Reset"})})]})]})]})})})},Vt=t=>{const{isOpen:r,setIsOpen:n,handleDelete:s,_id:o}=t,c=()=>n(!1);return a(K,{show:r,onHide:c,centered:!0,children:[e(K.Header,{closeButton:!0,children:e(K.Title,{children:"Confirm Delete"})}),a(K.Body,{children:[e("p",{children:"Are you sure you want to delete ?"}),e("h4",{children:o})]}),a(K.Footer,{children:[e(N,{variant:"secondary",onClick:c,children:"Cancel"}),e(N,{variant:"danger",onClick:s,children:"Delete"})]})]})},Ut=()=>{const[t,r]=i.exports.useState(null),[n,s]=i.exports.useState(!1),[o,c]=i.exports.useState(null),{user:h}=i.exports.useContext(M),u=U();if(i.exports.useEffect(()=>{(async()=>{if(h){const d=await Ot(h);if(d.error)return;r(d.docs)}})()},[h,n]),!t)return a("div",{children:[e("h1",{children:"Manage My Organizations"}),e(V,{})]});const x=(d,m)=>{u(`/org/${d}/create-election`,{state:m})},p=d=>{c(d),s(d)},f=async d=>{if(console.log("delete called"),(await Pt(d)).error){alert("Some error occured");return}s(!1)};return a("div",{children:[e(Vt,{isOpen:n,setIsOpen:s,_id:o,handleDelete:()=>f(o)}),e("h1",{children:"Manage My Organizations"}),t.length===0?e("h3",{children:"No Organizations found!!"}):e(E,{as:"ol",numbered:!0,className:"",children:t==null?void 0:t.map(d=>{const{organisationName:m,_id:b}=d;return a(E.Item,{as:"li",className:"d-flex flex-row",children:[a(F,{to:`/org/${b}`,style:{textDecoration:"none"},className:"flex-grow-1 px-3",children:[m,a("p",{children:["ID: ",b]})]}),e(N,{className:"align-self-center",onClick:()=>x(b,m),children:"Create Election"}),e("p",{className:"align-self-center text-danger m-3",style:{cursor:"pointer"},onClick:()=>p(b),children:"Delete"})]},b)})})]})},Kt=()=>{const t=Q();U();let r=t.pathname.split("/")[2];return console.log(r),a("div",{children:[e("h2",{children:"Organization Details"}),"Id - ",r]})},Yt=()=>{let r=Q().pathname.split("/")[2];return console.log(r),a("div",{children:[e("h1",{children:"Election Details"}),r]})};const Jt=()=>{const t=Q();let r=t.pathname.split("/")[2],n=t.state;const[s,o]=i.exports.useState({title:"",openTimestamp:new Date,closeTimestamp:new Date}),[c,h]=i.exports.useState(null),[u,x]=i.exports.useState(null);i.exports.useContext(M);const p=async d=>{d.preventDefault();try{const m=await Lt(s,r),{_id:b}=m;h(`/elections/${b}/manage`)}catch(m){console.log(m.response),x(m.response.data)}},f=d=>{d.preventDefault(),h(`/org/${r}`)};return c?e(te,{to:c,replace:!0}):a("div",{className:"d-flex flex-column justify-content-center align-items-center",style:{height:"70vh"},children:[e("h2",{className:"my-5",children:"Create an Election"}),a(l,{onSubmit:p,onReset:f,className:"bg-light rounded px-4 py-4",style:{background:"pink",minWidth:"40%"},children:[a(l.Group,{className:"my-4",controlId:"electionTitle",children:[e(l.Label,{children:"Title"}),e(l.Control,{type:"text",placeholder:"Enter election title",value:s.title,onChange:d=>{o(m=>L(D({},m),{title:d.target.value}))}})]}),a(l.Group,{className:"my-4",controlId:"organizer",children:[e(l.Label,{children:"Organization Name"}),e(l.Control,{type:"text",value:n,disabled:!0})]}),a("div",{className:"my-4",children:[e("label",{children:"Election Start Time"}),e("br",{}),e(se,{className:"w-100",onChange:d=>{o(m=>L(D({},m),{openTimestamp:d}))},value:s.openTimestamp,minDate:new Date,required:!0})]}),a("div",{className:"my-4",children:[e("label",{children:"Election End Time"}),e("br",{}),e(se,{className:"w-100",onChange:d=>{o(m=>L(D({},m),{closeTimestamp:d}))},value:s.closeTimestamp,minDate:s.openTimestamp})]}),e("br",{}),a("div",{className:"d-flex justify-content-center",children:[e(N,{variant:"secondary",type:"reset",className:"mx-4 px-3",children:"Discard"}),e(N,{variant:"success",type:"submit",className:"mx-4 px-4",children:"Save"})]})]}),u&&e(W,{variant:"danger",children:u})]})},Xt=t=>{const{candidates:r,handleDeleteCandidate:n}=t;return e(z,{children:(r==null?void 0:r.length)?e(E,{as:"ol",numbered:!0,children:r.map((s,o)=>a(E.Item,{as:"li",className:"d-flex align-items-center",children:[s.name,e(N,{variant:"outline-danger",className:"ms-auto",onClick:()=>n(s._id),children:"Delete"})]},s._id))}):"No candidates"})},Qt=()=>{const[t,r]=i.exports.useState(!1),[n,s]=i.exports.useState(!1),[o,c]=i.exports.useState(!1),h=i.exports.useRef(""),u=i.exports.useRef(!0),[x,p]=i.exports.useState([]),[f,d]=i.exports.useState({closeTimestamp:"",openTimestamp:"",organiser:"",title:"",registrationLink:""}),m=Q(),b=U();let T=m.pathname.split("/")[2];i.exports.useEffect(()=>((async()=>{s(!0);const g=await Mt(T);if(g.error){r("Invalid Election Id"),s(!1);return}g.deploymentAddress&&(alert("Election has already been deployed"),b(`/elections/${T}`,{replace:!0})),d(L(D({},g),{openTimestamp:new Date(g.openTimestamp),closeTimestamp:new Date(g.closeTimestamp)})),r(!1),s(!1)})(),()=>{r(!1),s(!1)}),[o]),i.exports.useEffect(()=>{(async()=>{const g=await pe(T);p(g)})()},[]);const k=async g=>{g.preventDefault();try{const C=await $t(T,f);c(w=>!w),u.current=!0}catch(C){console.log(C.response),r(C.response.data)}},S=g=>{g.preventDefault(),u.current=!0,c(C=>!C)},y=async()=>{const g=h.current.value;if(g=="")return;try{const w=await Bt(T,{name:g})}catch(w){console.log(w.response),r(w.response.data);return}const C=await pe(T);p(C)},I=async g=>{try{const w=await Ht(T,g)}catch(w){console.log(w.response),r(w.response.data);return}const C=await pe(T);p(C)},Z=async()=>{try{u.current=!1;const g=await zt(T);console.log(g)}catch(g){console.log(g.response),r(g.response.data),u.current=!0;return}B("Election has been deployed !!",{position,autoClose:5e3,closeOnClick:!0})};return a("div",{className:"d-flex flex-column",children:[e("h1",{children:"Manage Election"}),n?e(V,{}):a("div",{className:"d-flex justify-content-around ",children:[a(l,{onSubmit:k,onReset:S,className:"bg-light rounded px-4 py-4",style:{background:"pink",width:"40%"},children:[a(l.Group,{className:"my-4",controlId:"electionTitle",children:[e(l.Label,{children:"Title"}),e(l.Control,{type:"text",placeholder:"Enter election title",value:f.title,onChange:g=>{u.current=!1,d(C=>L(D({},C),{title:g.target.value}))}})]}),a(l.Group,{className:"my-4",controlId:"electionId",children:[e(l.Label,{children:"Election Id"}),e(l.Control,{type:"text",value:T,disabled:!0})]}),a(l.Group,{className:"my-4",controlId:"organizer",children:[e(l.Label,{children:"Organization Name"}),e(l.Control,{type:"text",value:f.organiser,disabled:!0})]}),a("div",{className:"my-4",children:[e("label",{children:"Election Start Time"}),e("br",{}),e(se,{className:"w-100",onChange:g=>{u.current=!1,d(C=>L(D({},C),{openTimestamp:g}))},value:f.openTimestamp,minDate:new Date,required:!0})]}),a("div",{className:"my-4",children:[e("label",{children:"Election End Time"}),e("br",{}),e(se,{className:"w-100",onChange:g=>{u.current=!1,d(C=>L(D({},C),{closeTimestamp:g}))},value:f.closeTimestamp,minDate:f.openTimestamp})]}),e("br",{}),a("div",{className:"d-flex justify-content-center",children:[e(N,{variant:"secondary",type:"reset",className:"mx-4 px-3",children:"Discard"}),e(N,{variant:"success",type:"submit",className:"mx-4 px-4",children:"Save"})]})]}),a("div",{className:"text-center bg-light px-3 py-2 rounded",style:{width:"40%",overflowY:"scroll",maxHeight:"70vh"},children:[e("h3",{children:"Candidates"}),a("div",{children:[e("input",{type:"text",ref:h,placeholder:"Candidate Name",className:"rounded px-3 py-2 shadow-sm mx-2",style:{outline:"none",border:"none",width:"60%"}}),e(N,{className:"my-3",onClick:y,children:"Add Candidate"})]}),e(Xt,{candidates:x,handleDeleteCandidate:I})]})]}),e(N,{className:"align-self-center my-4",disabled:!u.current,onClick:()=>{window.confirm(`An Election once deployed cannot be modified. 
Are you sure you want to continue?`)&&Z()},children:"Deploy Election"}),t&&e(W,{variant:"danger",children:t})]})},Zt=()=>{const[t,r]=i.exports.useState(""),[n,s]=i.exports.useState(""),[o,c]=i.exports.useState(""),[h,u]=i.exports.useState(""),[x,p]=i.exports.useState(!1),[f,d]=i.exports.useState(!1),[m,b]=i.exports.useState(Ft[0].value),T=U(),{isAuth:k,setIsAuth:S,loading:y,setLoading:I}=i.exports.useContext(M);return i.exports.useEffect(()=>{S("token"in localStorage),k&&(I(!1),T("/dashboard",{replace:!0}))},[k]),e(z,{children:y?e(V,{}):e(z,{children:e("div",{children:a(re,{children:[e("h1",{children:"Forgot Password"}),f&&e(W,{variant:"success",children:f}),x&&e(W,{variant:"danger",children:x}),a(l,{onSubmit:async g=>{if(g.preventDefault(),p(!1),d(!1),o!==h){p("Passwords don't match");return}switch(m){case"1":I(!0);const C="OTP for Forgot Password";try{await ke({email:t,purpose:C}),b("2")}catch(w){console.log(w),w.response&&w.response.data.message?p(w.response.data.message):p(w.message)}I(!1);break;case"2":I(!0);try{await Te({email:t,otp:n}),b("3")}catch(w){console.log(w),w.response&&w.response.data.message?p(w.response.data.message):p(w.message)}I(!1);break;case"3":I(!0);try{await Se({email:t,password:o}),d("Password has been changed")}catch(w){console.log(w),w.response&&w.response.data.message?p(w.response.data.message):p(w.message)}I(!1);break}},children:[(m==="1"||m==="2")&&a(l.Group,{controlId:"email",children:[e(l.Label,{children:"Email Address"}),e(l.Control,{type:"email",placeholder:"Enter your email",value:t,required:!0,onChange:g=>{p(!1),r(g.target.value)}})]}),m==="2"&&a(l.Group,{controlId:"otp",children:[e(l.Label,{children:"OTP"}),e(l.Control,{type:"text",placeholder:"Enter OTP received on email",value:n,required:!0,onChange:g=>{p(!1),s(g.target.value)}})]}),m==="3"&&a(l.Group,{controlId:"password",children:[e(l.Label,{children:"Password"}),e(l.Control,{type:"password",placeholder:"Enter new Password",value:o,required:!0,onChange:g=>{p(!1),c(g.target.value)}})]}),m==="3"&&a(l.Group,{controlId:"confirmPassword",children:[e(l.Label,{children:"Confirm Password"}),e(l.Control,{type:"password",placeholder:"Confirm your new Password",value:h,required:!0,onChange:g=>{p(!1),u(g.target.value)}})]}),e(q,{className:"py-3",children:e($,{children:e(N,{type:"submit",variant:"primary",children:m=="1"?"Send OTP":m=="2"?"Confirm OTP":"Change Password"})})})]})]})})})})};var er="./assets/fourOfour.e2f25f95.jpeg";const tr=()=>{const{loading:t,isAuth:r,setIsAuth:n}=i.exports.useContext(M);return i.exports.useEffect(()=>{n("token"in localStorage)}),e("div",{children:t?e(V,{}):a(z,{children:[a(F,{to:r?"/dashboard":"/",children:[e(Qe,{}),"Go back to the home page"]}),e("img",{src:er})]})})},rr=()=>{const{user:t,setUser:r,setIsAuth:n,setLoading:s}=i.exports.useContext(M),o=localStorage.getItem("token"),[c,h]=i.exports.useState(!1);return i.exports.useEffect(()=>{(async()=>{if(o&&!t){const u=await St();u.error?(n(!1),s(!1),h(!0)):(r(u),n(!0))}})()},[o]),c?(localStorage.removeItem("token"),e(te,{to:"/"})):(console.log("via private route"),o?e(Ce,{}):e(te,{to:"/login"}))},ar=()=>(console.log("Organizer route"),e(Ce,{})),nr=()=>{const{chainId:t,setChainId:r}=i.exports.useContext(M);return a(Ze,{children:[a("main",{className:"App py-3 bg-gray",children:[e(X,{children:e(dt,{})}),t!==80001&&a("p",{className:"alert alert-warning text-center",style:{padding:0,marginTop:0},children:["You are currently on ",e("span",{className:"fw-bold",children:Ie(t)}),", please switch to ",e("span",{className:"fw-bold",children:Ie(80001)}),". You can follow these ",e("span",{children:e("a",{className:"fw-bold",target:"_blank",rel:"noreferrer",href:"https://docs.polygon.technology/docs/develop/metamask/config-polygon-on-metamask/",children:"steps"})})]}),e(X,{children:a(et,{children:[e(H,{path:"*",element:e(tr,{})}),e(H,{exact:!0,path:"/",element:e(Ct,{})}),e(H,{path:"/login",element:e(Tt,{})}),e(H,{path:"/signup",element:e(Et,{})}),e(H,{path:"/forgotpassword",element:e(Zt,{})}),a(H,{path:"/",element:e(rr,{}),children:[e(H,{exact:!0,path:"/dashboard",element:e(Gt,{})}),e(H,{exact:!0,path:"/dashboard/wallet",element:e(_t,{})}),e(H,{exact:!0,path:"/elections/:id",element:e(Yt,{})}),e(H,{exact:!0,path:"/elections/:id/manage",element:e(Qt,{})}),e(H,{exact:!0,path:"/verifyEmail",element:e(qt,{})}),e(H,{exact:!0,path:"/changePassword",element:e(Wt,{})}),a(H,{path:"/org",element:e(ar,{}),children:[e(H,{path:"/org",element:e(Ut,{})}),e(H,{path:"/org/:id",element:e(Kt,{})}),e(H,{path:"/org/:id/create-election",element:e(Jt,{})})]})]})]})})]}),e(tt,{style:{width:"30em"}})]})};rt.render(e(nt,{children:e(nr,{})}),document.getElementById("root"));
