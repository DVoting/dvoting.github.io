var Be=Object.defineProperty,Re=Object.defineProperties;var Ve=Object.getOwnPropertyDescriptors;var xe=Object.getOwnPropertySymbols;var He=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable;var Te=(t,n,a)=>n in t?Be(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,L=(t,n)=>{for(var a in n||(n={}))He.call(n,a)&&Te(t,a,n[a]);if(xe)for(var a of xe(n))_e.call(n,a)&&Te(t,a,n[a]);return t},M=(t,n)=>Re(t,Ve(n));import{r as i,j as e,W as de,a as r,R as I,t as k,N as ue,C as ne,b as se,c as ae,F as G,d as Ge,e as ze,f as qe,V as Fe,B as je,g as Ce,h as O,i as Ie,k as D,A as We,l as Ue,M as Ke,m as Je,n as Ye,S as Xe,o as Qe,p as Ze,q as K,s as B,u as e0,v as t0,w as Q,x as V,y as ee,z as c,L as U,D as Z,E as Se,G as te,H as A,T as n0,I as ie,P as Ne,J as ke,K as Ee,O as a0,Q as r0,U as s0,X as le,Y as o0,Z as i0,_ as l0,$ as Oe,a0 as f0,a1 as c0,a2 as _,a3 as d0,a4 as u0}from"./vendor.f79b58f0.js";const p0=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const f of o)if(f.type==="childList")for(const h of f.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function a(o){const f={};return o.integrity&&(f.integrity=o.integrity),o.referrerpolicy&&(f.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?f.credentials="include":o.crossorigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function s(o){if(o.ep)return;o.ep=!0;const f=a(o);fetch(o.href,f)}};p0();const R=i.exports.createContext({user:null,walletId:null,isAuth:!1,loading:!1}),h0=t=>{const[n,a]=i.exports.useState(""),[s,o]=i.exports.useState(80001),[f,h]=i.exports.useState(null),[u,m]=i.exports.useState(!1),[d,l]=i.exports.useState(!1);return e(R.Provider,{value:{user:f,setUser:h,walletId:n,setWalletId:a,isAuth:u,setIsAuth:m,loading:d,setLoading:l,chainId:s,setChainId:o},children:t.children})};let pe;if(window.ethereum)console.log("MetaMask is installed!"),pe=new de(window.ethereum);else{console.log("MetaMask is NOT installed!");const t="https://speedy-nodes-nyc.moralis.io/2aa1ce4616e3c936bfbb33b8/polygon/mumbai",n=new de.providers.HttpProvider(t,{chainId:80001,name:"Mumbai"});pe=new de(n)}var J=pe;const j=(t,n)=>r(I.Fragment,{children:[e("span",{children:t||""}),e("br",{}),e("span",{children:n||""})]}),m0={1:"Ethereum Main Network",2:"Expanse Network",3:"Ropsten Test Network",4:"Rinkeby Test Network",5:"Goerli Test Network",42:"Kovan Test Network",56:"BSC Main Network",97:"BSC Test Network",43114:"Avalanche Main C-Chain",43113:"Avalanche FUJI C-Chain",137:"Polygon Main Network",80001:"Mumbai Test Network"},he=t=>m0[t]||`Unknown Network (${t})`,me=80001;async function b0(t,n){var o;let a=(o=JSON.parse(localStorage.getItem("walletDisabled")))!=null?o:!1;console.log(a);let s=await J.eth.getChainId();n(s),window.ethereum&&(J.eth.getAccounts().then(f=>{a||t(f[0]||"")}).catch(console.log),window.ethereum.on("accountsChanged",f=>{var u;((u=JSON.parse(localStorage.getItem("walletDisabled")))!=null?u:!1)||t(f[0]||"")}),window.ethereum.on("chainChanged",async()=>{s=await J.eth.getChainId(),n(s)}))}async function g0(t){localStorage.setItem("walletDisabled",!0),t("")}async function y0(t){if(!window.ethereum){k.error(j("Provider Error","MetaMask is NOT installed!"),{position:k.POSITION.BOTTOM_RIGHT,autoClose:5e3,toastId:"providerError",closeOnClick:!0,pauseOnHover:!1,draggable:!1});return}localStorage.setItem("walletDisabled",!1);try{const n=await window.ethereum.request({method:"eth_requestAccounts"});t(n[0]||"")}catch(n){console.log(n)}}async function De(t){console.log(t);let[n]=await J.eth.getAccounts();try{return await J.eth.personal.sign(J.utils.keccak256(t),n,null)}catch(a){return k.error(j(a.message.split(":")[0],a.message.split(":")[1]),{position:k.POSITION.BOTTOM_RIGHT,autoClose:5e3,toastId:"signatureError",closeOnClick:!0,pauseOnHover:!1,draggable:!1}),null}}const v0=()=>{const{user:t,setUser:n,isAuth:a,setIsAuth:s,setLoading:o}=i.exports.useContext(R),{walletId:f,setWalletId:h}=i.exports.useContext(R),{chainId:u,setChainId:m}=i.exports.useContext(R),d=()=>{localStorage.removeItem("token"),s(!1),n(null),o(!1)};return i.exports.useEffect(async()=>{await b0(h,m)},[]),e("header",{children:e(ue,{children:r(ne,{children:[e(se.LinkContainer,{to:a?"/dashboard":"/",children:e(ue.Brand,{children:e("h2",{children:"DVoting"})})}),e(se.LinkContainer,{to:"/explore",style:{marginRight:"auto"},children:e(ae.Link,{children:"Explore"})}),e(ue.Toggle,{"aria-controls":"basic-navbar-nav"}),r(ae,{className:"ml-auto",children:[t?e(G,{children:r(Ge,{children:[t.name,e(se.LinkContainer,{to:"#",onClick:d,children:r(ae.Link,{children:[e(ze,{})," Logout"]})})]})}):r(G,{children:[e(se.LinkContainer,{to:"/login",children:r(ae.Link,{children:[e(qe,{})," Log In"]})}),e(se.LinkContainer,{to:"/signup",children:r(ae.Link,{children:[e(Fe,{})," SignUp"]})})]}),f===""?r(ae.Link,{onClick:()=>y0(h),children:[e(je,{size:20})," Connect Wallet"]}):e(Ce,{title:f.slice(0,4)+"..."+f.slice(-4),children:e(Ce.Item,{onClick:()=>g0(h),children:"Disconnect"})})]})]})})})},w0=()=>r("footer",{className:"text-center",children:["\xA9 2022 |"," ",e("a",{href:"https://github.com/DVoting/dvoting.github.io",children:"D-Voting"})]});var x0="./assets/vote.90a295f2.png";const T0="_root1_zwkyz_1",C0="_root2_zwkyz_5",I0="_root3_zwkyz_11";var be={root1:T0,root2:C0,root3:I0};const S0=()=>r("div",{className:`${be.root1} d-flex justify-content-evenly align-items-center py-5`,style:{minHeight:"85vh"},children:[r("div",{className:"",style:{maxWidth:"45%"},children:[r("div",{className:"display-4 fw-bold",children:["Empowering India",e("p",{className:"text-info",children:"Through Blockchain"})]}),r("div",{className:"py-5",children:[e("p",{children:"A De-centralized Voting App which addresses the issue of maintaining anonymity of voters on a public blockchain network, achieving lower latency and affordability in the existing models."}),e(O,{variant:"outline-primary",className:"px-4 py-2",href:"/login",children:"Login"}),e(O,{variant:"info",className:"px-4 py-2 mx-5",href:"/signup",children:"Get Started"})]})]}),e("div",{className:"",style:{maxWidth:"30%"},children:e("img",{src:x0,style:{maxWidth:"100%"}})})]}),ge=[{Icon:We,title:"Safe and Secure",description:"The casted votes are safely and securely stored in the blockchain database, which mitigates any form of manipulation / tampering like the deletion of legitimate votes or the addition of illegitimate votes."},{Icon:Ue,title:"Accuracy with Transparency",description:"The casting of votes and tallying of the votes would be a lot quicker while also providing better transparency and accuracy."},{Icon:Ke,title:"Privacy OP :)",description:"We do not link your Wallet address and your profile identity, thereby keeping your vote anonymous. Also, you can verify that your vote has been recorded or not using the Transaction Id."}],N0=()=>r("div",{className:be.root2,children:[e("h1",{className:"fw-bold",children:"Notable Features"}),e(Ie,{children:ge==null?void 0:ge.map((t,n)=>{const{Icon:a,title:s,description:o}=t;return r(D,{className:"rounded-3 d-flex flex-direction-col justify-content-center align-items-center px-3 py-4 mx-4 my-5",children:[e(a,{size:50,className:"m-3"}),r(D.Body,{className:"px-4",children:[e(D.Title,{className:"fw-bold",children:s}),e(D.Text,{style:{textAlign:"justify"},children:o})]})]},n)})})]}),ye=[{Icon:Je,title:"React"},{Icon:Ye,title:"Node.js"},{Icon:Xe,title:"Solidity"},{Icon:Qe,title:"Web3"},{Icon:Ze,title:"VS Code"}],k0=()=>r("div",{className:be.root3,children:[e("h2",{className:"fw-bold",children:"Tech Stack"}),e(Ie,{children:ye==null?void 0:ye.map((t,n)=>{const{Icon:a,title:s}=t;return r(D,{className:"rounded-pill d-flex flex-direction-col justify-content-center align-items-center mx-4 my-5 shadow-sm",children:[e(a,{size:50,className:"m-3"}),e(D.Body,{className:"",children:e(D.Title,{className:"fw-bold",children:s})})]},n)})})]});var E0="./assets/curve-1.bf7c1ae6.png",O0="./assets/curve-2.d369b78c.png",D0="./assets/curve-3.d6a5c9dd.png";const oe=({children:t})=>e(ne,{children:e(K,{className:"justify-content-md-center",children:e(B,{xs:12,md:6,children:t})})}),Y=({variant:t,children:n})=>e(e0,{variant:t,children:n});Y.defaultProps={variant:"info"};const W=()=>e(t0,{animation:"border",role:"status",style:{width:"4vh",height:"4vh",margin:"25vh auto",display:"block",color:"black"}}),P0=()=>{const{isAuth:t,setIsAuth:n,loading:a,setLoading:s}=i.exports.useContext(R),o=Q();return I.useEffect(()=>{s(!0),n("token"in localStorage),t&&o("/dashboard",{replace:!0}),s(!1)},[t]),e(G,{children:a?e(W,{}):e(G,{children:r("div",{style:{minHeight:"150vh",width:"100%"},children:[e("img",{src:E0,style:{position:"absolute",right:"0px",maxWidth:"60%",zIndex:"-1"}}),e(S0,{}),e("img",{src:O0,style:{position:"absolute",left:"0px",maxWidth:"20%",zIndex:"-1"}}),e(N0,{}),e("img",{src:D0,style:{position:"absolute",right:"0px",maxWidth:"18%",zIndex:"-1"}}),e(k0,{}),e(w0,{})]})})})},H="https://dvoting-server.vercel.app/api";Date.prototype.addHours=function(t){return this.setTime(this.getTime()+t*60*60*1e3),this};const A0=async t=>{try{const n={headers:{"Content-Type":"application/json"}},a=await V.post(`${H}/users/login`,t,n);return localStorage.setItem("token",a.data.token),a.data}catch(n){throw n}},$0=async()=>{const t=localStorage.getItem("token"),n={headers:{"Content-type":"application/json",Authorization:`Bearer ${t}`}};try{const{data:a}=await V.get(`${H}/users/profile`,n);return M(L({},a),{error:!1})}catch(a){return console.log(a.response),M(L({},a),{error:!0})}},L0=async t=>{try{const n={headers:{"Content-Type":"application/json"}},a=await V.post(`${H}/users`,t,n);return localStorage.setItem("token",a.data.token),a.data}catch(n){throw n}},M0=async t=>{const n=localStorage.getItem("token");try{const a={headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}},s=await V.put(`${H}/users/verify`,t,a);return localStorage.setItem("token",s.data.token),s.data}catch(a){throw a}},Pe=async t=>{try{const n={headers:{"Content-Type":"application/json"}};return(await V.put(`${H}/users/profile`,t,n)).data}catch(n){throw n}},B0=()=>{const[t,n]=i.exports.useState(""),[a,s]=i.exports.useState(""),[o,f]=i.exports.useState(!1),h=ee(),u=Q(),m=h.search?h.search.split("=")[1]:"/",{isAuth:d,setIsAuth:l,loading:g,setLoading:w}=i.exports.useContext(R);return i.exports.useEffect(()=>{l("token"in localStorage),d&&(w(!1),u("/dashboard",{replace:!0}))},[d]),e(G,{children:g?e(W,{}):e(G,{children:e("div",{children:r(oe,{children:[e("h1",{children:"Login"}),o&&e(Y,{variant:"danger",children:o}),r(c,{onSubmit:async v=>{v.preventDefault(),w(!0);try{await A0({email:t,password:a}),l("token"in localStorage)}catch(y){console.log(y),y.response&&y.response.data.message?f(y.response.data.message):f(y.message)}w(!1)},onReset:v=>{v.preventDefault(),n(""),s("")},children:[r(c.Group,{controlId:"email",children:[e(c.Label,{children:"Email Address"}),e(c.Control,{type:"email",placeholder:"Enter email",value:t,required:!0,onChange:v=>{f(!1),n(v.target.value)}})]}),r(c.Group,{controlId:"password",children:[e(c.Label,{children:"Password"}),e(c.Control,{type:"password",placeholder:"Enter password",value:a,required:!0,onChange:v=>{f(!1),s(v.target.value)}})]}),r(K,{className:"py-3",children:[e(B,{children:e(O,{type:"submit",variant:"primary",children:"Sign In"})}),e(B,{children:e(O,{type:"reset",variant:"primary",children:"Reset"})})]}),r(K,{children:[r(B,{children:["New User?"," ",e(U,{to:m?`/signup?redirect=${m}`:"/signup",children:"Register Here"})]}),e(B,{children:e(U,{to:m?`/forgotpassword?redirect=${m}`:"/forgotpassword",children:"Forgot Password?"})})]})]})]})})})})},R0=()=>{const[t,n]=i.exports.useState(""),[a,s]=i.exports.useState(""),[o,f]=i.exports.useState(""),[h,u]=i.exports.useState(""),[m,d]=i.exports.useState("voter"),[l,g]=i.exports.useState(!1),w=ee(),b=Q(),x=w.search?w.search.split("=")[1]:"/",{isAuth:v,setIsAuth:y,loading:S,setLoading:p}=i.exports.useContext(R);return i.exports.useEffect(()=>{y("token"in localStorage),v&&(p(!1),b("/dashboard",{replace:!0}))},[v]),e(G,{children:S?e(W,{}):e(G,{children:e("div",{children:r(oe,{children:[e("h1",{children:"SignUp"}),l&&e(Y,{variant:"danger",children:l}),r(c,{onSubmit:async C=>{C.preventDefault(),p(!0);try{await L0({username:a,email:o,password:h,name:t,userType:m}),y("token"in localStorage)}catch(N){console.log(N),N.response&&N.response.data.message?g(N.response.data.message):g(N.message)}p(!1)},onReset:C=>{C.preventDefault(),n(""),s(""),f(""),u(""),d("voter")},children:[r(c.Group,{controlId:"name",children:[e(c.Label,{children:"Name"}),e(c.Control,{type:"text",placeholder:"Enter name",value:t,required:!0,onChange:C=>{g(!1),n(C.target.value)}})]}),r(c.Group,{controlId:"username",children:[e(c.Label,{children:"Username"}),e(c.Control,{type:"text",placeholder:"Enter username",value:a,required:!0,onChange:C=>{g(!1),s(C.target.value)}})]}),r(c.Group,{controlId:"email",children:[e(c.Label,{children:"Email Address"}),e(c.Control,{type:"email",placeholder:"Enter email",value:o,required:!0,onChange:C=>{g(!1),f(C.target.value)}})]}),r(c.Group,{controlId:"password",children:[e(c.Label,{children:"Password"}),e(c.Control,{type:"password",placeholder:"Enter password",value:h,required:!0,onChange:C=>{g(!1),u(C.target.value)}})]}),r(K,{className:"py-3",children:[e(B,{children:e(O,{type:"submit",variant:"primary",children:"Sign Up"})}),e(B,{children:e(O,{type:"reset",variant:"primary",children:"Reset"})})]}),e(K,{children:r(B,{children:["Already registered?"," ",e(U,{to:x?`/login?redirect=${x}`:"/signup",children:"Login Here"})]})})]})]})})})})},V0=async t=>{const n=localStorage.getItem("token"),a={headers:{"Content-type":"application/json",Authorization:`Bearer ${n}`}},s=t._id;try{const{data:o}=await V.get(`${H}/organisers?user=${s}`,a);return M(L({},o),{error:!1})}catch(o){return console.log(o),M(L({},o),{error:!0})}},H0=async t=>{const n=localStorage.getItem("token"),a={headers:{"Content-type":"application/json",Authorization:`Bearer ${n}`}};try{const{data:s}=await V.delete(`${H}/organisers/${t}`,a);return M(L({},s),{error:!1})}catch(s){return console.log(s),M(L({},s),{error:!0})}};async function _0(t){const n=localStorage.getItem("token"),a={headers:{"Content-type":"application/json",Authorization:`Bearer ${n}`}};try{const{data:s}=await V.post(`${H}/organisers`,t,a);return console.log(s),s}catch(s){return console.log(s),M(L({},s.response),{error:!0})}}const Ae=t=>{const{show:n,setShow:a,setRedirect:s}=t,[o,f]=I.useState({organisationName:""}),h=d=>{f(M(L({},o),{[d.target.name]:d.target.value}))},u=async d=>{if(d.preventDefault(),!m())return;const l=await _0(o);if(l.error){console.log(l),k.error(j(`error ${l.status}`,`${l.data&&l.data.message||l.statusText}`),{position:k.POSITION.BOTTOM_RIGHT});return}f(g=>M(L({},g),{organisationName:""})),a(!1),s("/org")},m=()=>o.organisationName.length<4?(k.error(j("Organiser Name","must be at least 4 characters long"),{position:k.POSITION.BOTTOM_RIGHT}),!1):!0;return r(Z,{size:"lg",show:n,onHide:()=>a(!1),"aria-labelledby":"createOrganiserModal",children:[e(Z.Header,{closeButton:!0,children:e(Z.Title,{id:"createOrganiserModal",children:"Create Organiser"})}),e(Z.Body,{children:r(c,{children:[e(Se,{label:"Organiser name",className:"mb-3",children:e(c.Control,{type:"text",name:"organisationName",value:o.organisationName,onChange:h,required:!0})}),e(O,{className:"text-center",variant:"primary",type:"submit",onClick:u,children:"Create"})]})})]})},G0=async(t,n)=>{const a=localStorage.getItem("token"),s={headers:{"Content-type":"application/json",Authorization:`Bearer ${a}`}},o=M(L({},t),{organiser:n});try{const{data:f}=await V.post(`${H}/elections`,o,s);return f}catch(f){throw f}};async function re(t){try{const{data:n}=await V.get(`${H}/elections?${t}`);return n.docs}catch(n){return console.log(n),null}}async function z0(t,n){const a=localStorage.getItem("token"),s={headers:{"Content-type":"application/json",Authorization:`Bearer ${a}`}};try{const{data:o}=await V.put(`${H}/elections/${t}`,n,s);return o}catch(o){throw o}}async function fe(t){try{const{data:n}=await V.get(`${H}/elections/${t}`);return n}catch(n){return M(L({},n),{error:!0})}}async function ce(t){try{const{data:n}=await V.get(`${H}/elections/${t}/candidates`);return n}catch(n){console.log(n)}}async function q0(t,n){const a=localStorage.getItem("token"),s={headers:{"Content-type":"application/json",Authorization:`Bearer ${a}`}};try{const{data:o}=await V.post(`${H}/elections/${t}/candidates`,n,s);return o}catch(o){throw o}}async function F0(t,n){const a=localStorage.getItem("token"),s={headers:{"Content-type":"application/json",Authorization:`Bearer ${a}`}};try{const{data:o}=await V.delete(`${H}/elections/${t}/candidates/${n}`,s);return o}catch(o){throw o}}async function j0(t){const n=localStorage.getItem("token"),a={headers:{"Content-type":"application/json",Authorization:`Bearer ${n}`}};try{const{data:s}=await V.patch(`${H}/elections/${t}/deploy`,{},a);return s}catch(s){throw s}}async function W0(t){const n=localStorage.getItem("token"),a={headers:{"Content-type":"application/json",Authorization:`Bearer ${n}`}};try{const{data:s}=await V.patch(`${H}/elections/${t}/vote`,{},a);return s}catch(s){throw s}}async function ve(t){try{const{data:n}=await V.get(`${H}/voters/${t}`);return console.log(n),n}catch(n){return console.log(n),null}}async function U0(t){const n=localStorage.getItem("token"),a={headers:{"Content-type":"application/json",Authorization:`Bearer ${n}`}};try{const{data:s}=await V.patch(`${H}/voters/wallet`,t,a);return console.log(s),s}catch(s){return console.log(s),M(L({},s.response),{error:!0})}}async function K0(t,n){const a=localStorage.getItem("token"),s={headers:{"Content-type":"application/json",Authorization:`Bearer ${a}`}};try{const{data:o}=await V.patch(`${H}/elections/${t}/wallet`,n,s);return console.log(o),o}catch(o){return console.log(o),M(L({},o.response),{error:!0})}}const J0=()=>{const{user:t,loading:n,setLoading:a}=I.useContext(R),[s,o]=I.useState(!1),[f,h]=I.useState(null),[u,m]=I.useState([]),[d,l]=I.useState([]),[g,w]=I.useState([]),[b,x]=I.useState([]),[v,y]=I.useState(null);let S=new Date().toISOString();return I.useEffect(()=>{a(t===null),console.log(t)},[t]),I.useEffect(async()=>{t&&h(await ve(t.uniqueVoterId))},[t]),I.useEffect(async()=>{if(f&&f.invitations.length>0){const p=`ids=${f.invitations.join(",")}`;m((await re(p)).filter($=>S>=$.openTimestamp&&S<=$.closeTimestamp))}},[f]),I.useEffect(async()=>{if(t){const p=`appliedVoter=${t.uniqueVoterId}`;l((await re(p)).filter($=>S>=$.openTimestamp&&S<=$.closeTimestamp))}},[t]),I.useEffect(async()=>{if(t){const p=`approvedVoter=${t.uniqueVoterId}`;w((await re(p)).filter($=>S>=$.openTimestamp&&S<=$.closeTimestamp))}},[t]),I.useEffect(async()=>{if(t){const p=`appearedVoter=${t.uniqueVoterId}`;x(await re(p))}},[t]),v?e(te,{replace:!0,to:v}):n?e(W,{}):e(I.Fragment,{children:e(ne,{children:r(K,{children:[r(B,{md:12,lg:4,children:[e(D,{children:t&&r(I.Fragment,{children:[e(D.Header,{children:"User Profile"}),r(A,{variant:"flush",children:[r(A.Item,{children:["Username: ",t.username]}),r(A.Item,{children:["Name: ",t.name]}),r(A.Item,{children:["E-mail: ",t.email," ",t.emailVerified?e("span",{className:"text-success",children:"verified"}):e(U,{to:"/verifyEmail",children:"verify"})]}),r(A.Item,{children:["UVID: ",t.uniqueVoterId]}),f&&r(A.Item,{children:["Wallet:"," ",f.hasWallet?r(I.Fragment,{children:[e("span",{className:"text-success",children:"assigned"})," | ","Nonce: #",f.nonce]}):e(U,{to:"wallet",children:"generate"})]}),e(A.Item,{children:e(U,{to:"/changePassword",children:"Change Password"})})]})]})}),e(D,{style:{marginTop:"5%",marginBottom:"5%"},children:t&&r(A,{variant:"flush",children:[t.userType==="voter"&&r(I.Fragment,{children:[e(A.Item,{onClick:()=>o(!0),style:{cursor:"pointer"},children:"Register an Organisation"}),e(Ae,{show:s,setShow:o,setRedirect:y})]}),t.userType==="organiser"&&e(U,{to:"/org",children:e(A.Item,{children:"Manage Organizations"})})]})})]}),e(B,{md:12,lg:8,children:r(D,{children:[e(D.Header,{children:"Elections"}),e(D.Body,{children:f&&r(n0,{defaultActiveKey:"invited",className:"mb-3",children:[e(ie,{eventKey:"invited",title:"Invited",children:u.length>0?e(A,{variant:"flush",children:u.map(p=>e(U,{to:`/elections/${p._id}`,children:e(A.Item,{children:p.title})},p._id))}):e(I.Fragment,{children:"Nothing here... "})}),e(ie,{eventKey:"approved",title:"Approved",children:g.length>0?e(A,{variant:"flush",children:g.map(p=>e(U,{to:`/elections/${p._id}`,children:e(A.Item,{children:p.title})},p._id))}):e(I.Fragment,{children:"Nothing here... "})}),e(ie,{eventKey:"applied",title:"Applied",children:(d==null?void 0:d.length)>0?e(A,{variant:"flush",children:d.map(p=>e(U,{to:`/elections/${p._id}`,children:e(A.Item,{children:p.title})},p._id))}):e(I.Fragment,{children:"Nothing here... "})}),e(ie,{eventKey:"appeared",title:"Appeared",children:(b==null?void 0:b.length)>0?e(A,{variant:"flush",children:b==null?void 0:b.map(p=>e(U,{to:`/elections/${p._id}`,children:e(A.Item,{children:p.title})},p._id))}):e(I.Fragment,{children:"Nothing here... "})})]})})]})})]})})})},Y0=()=>{const{loading:t,setLoading:n,user:a}=I.useContext(R),{walletId:s,setWalletId:o}=i.exports.useContext(R),[f,h]=I.useState(null),[u,m]=I.useState(null),[d,l]=I.useState(""),[g,w]=I.useState(null),[b,x]=I.useState(null),[v,y]=I.useState(0),[S,p]=I.useState(!1);I.useEffect(()=>{let F="0",z=!1;document.addEventListener("mousemove",P=>{z=!0;let T=Math.sqrt(P.offsetX*P.offsetX+P.offsetY*P.offsetY);T=Math.round(T)*17%16,F=T.toString(16)}),setInterval(()=>{z=!1},200),setInterval(()=>{l(P=>(v<100&&y(Math.round(P.length/64*100)),P.length<64&&z?P+F:P))},100)},[]),I.useEffect(()=>{n(!a||!u),u&&u.hasWallet&&h("/dashboard"),console.log(a)},[a,u]),I.useEffect(async()=>{a&&m(await ve(a.uniqueVoterId))},[a]);const $=()=>{if(g)return;let F="";for(let P of d){let T=parseInt(P,16);T=T^Math.floor(Math.random()*16),F+=T.toString(16)}w(F);let z=J.eth.accounts.privateKeyToAccount(F);x(z.address),console.log(z)},E=async(F,z=null)=>{await navigator.clipboard.writeText(F),k.info(j(z,"copied to clipboard"),{position:k.POSITION.BOTTOM_CENTER,autoClose:500,hideProgressBar:!0,toastId:"copyToast"})},C=(F,z)=>{let P=document.createElement("a");P.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(z)),P.setAttribute("download",F),P.style.display="none",document.body.appendChild(P),P.click(),document.body.removeChild(P)},N=async()=>{if(!s){k.error(j("No wallet connected",null),{position:k.POSITION.BOTTOM_RIGHT,autoClose:5e3,toastId:"walletError",closeOnClick:!0,pauseOnHover:!1,draggable:!1});return}let F=JSON.stringify({voter:u._id,address:J.utils.toChecksumAddress(s)}),z=await De(F);if(!z)return;let P={address:J.utils.toChecksumAddress(s),signature:z};const T=await U0(P);if(T.error){console.log(T),k.error(j(`error ${T.status}`,`${T.data||T.statusText}`),{position:k.POSITION.BOTTOM_RIGHT});return}k.success(j("Approved Wallet",`${b}`),{position:k.POSITION.BOTTOM_RIGHT}),h("/dashboard")};return f?e(te,{replace:!0,to:f}):t?e(W,{}):e(I.Fragment,{children:e(ne,{children:r(K,{children:[e(B,{md:12,lg:2}),r(B,{md:12,lg:8,children:[r("p",{children:["Generating Ethereum Wallet...",e("br",{}),"MOVE your mouse around to add some extra randomness..."]}),r(c,{children:[r(Se,{label:"Randomness",className:"mb-3",children:[e(c.Control,{as:"textarea",value:d,disabled:!0,style:{resize:"none",height:"5rem"}}),v===100?e(Ne,{variant:"success",now:100,label:"Done"}):e(Ne,{now:v,label:`${v}%`})]}),e("div",{className:"d-grid gap-2",children:e(O,{variant:"primary",onClick:()=>$(),disabled:v!==100,children:"Generate Ethereum Wallet"})})]}),e("hr",{}),b&&r(c,{children:[r(c.Group,{className:"mb-3",children:[e(c.Label,{children:"Ethereum address"}),r(ke,{children:[e(c.Control,{type:"text",value:b,onChange:()=>{}}),e(O,{variant:"light",onClick:()=>E(b,"Address"),children:e(Ee,{})})]})]}),r(c.Group,{className:"mb-3",children:[e(c.Label,{children:"Private key"}),r(ke,{children:[e(c.Control,{type:S?"text":"password",value:g,onChange:()=>{}}),e(O,{variant:"light",onClick:()=>p(!S),children:S?e(a0,{size:20}):e(r0,{size:20})}),e(O,{variant:"light",onClick:()=>E(g,"Private key"),children:e(Ee,{})}),e(O,{variant:"light",onClick:()=>C("key.txt",g),children:e(s0,{})})]})]}),e("hr",{}),e(c.Group,{className:"mb-3",children:s.toLowerCase()===b.toLowerCase()?e(O,{variant:"primary",onClick:async()=>{await N()},children:"Approve Wallet"}):r("p",{className:"alert alert-info",children:["Before proceeding, connect the above wallet by importing it's private key."," ",e("a",{href:"https://metamask.zendesk.com/hc/en-us/articles/360015489331-How-to-import-an-Account",target:"_blank",rel:"noreferrer",children:"steps"})]})})]})]}),e(B,{md:12,lg:2})]})})})},X0=[{name:"Email not entered",value:"1"},{name:"OTP sent from server",value:"2"},{name:"Change password",value:"3"}],Q0=[{name:"Email not pressed",value:"1"},{name:"OTP sent from server",value:"2"}],$e=async t=>{try{const n={headers:{"Content-Type":"application/json"}};return(await V.put(`${H}/otp`,t,n)).data}catch(n){throw n}},Le=async t=>{try{const n={headers:{"Content-Type":"application/json"}};return(await V.patch(`${H}/otp/verify`,t,n)).data}catch(n){throw n}},Z0=()=>{const{user:t,loading:n,setLoading:a,setUser:s}=i.exports.useContext(R),[o,f]=i.exports.useState("fetching..."),[h,u]=i.exports.useState(""),[m,d]=i.exports.useState(Q0[0].value),[l,g]=i.exports.useState(!1),[w,b]=i.exports.useState(!1),x=Q();return i.exports.useEffect(()=>{a(!0),t&&(f(t.email),a(!1),t.emailVerified&&x("/dashboard",{replace:!0}))},[t]),e(G,{children:n?e(W,{}):e("div",{children:r(oe,{children:[e("h1",{children:"Verify Email"}),w&&e(Y,{variant:"success",children:w}),l&&e(Y,{variant:"danger",children:l}),e(c,{onSubmit:async y=>{switch(y.preventDefault(),g(!1),b(!1),m){case"1":a(!0);const S="OTP for e-mail Verification";try{await $e({email:o,purpose:S}),d("2")}catch(p){console.log(p),p.response&&p.response.data.message?g(p.response.data.message):g(p.message)}a(!1);break;case"2":a(!0);try{await Le({email:o,otp:h});const p=await M0({email:o});b("Email has been verified"),s(p),x("/dashboard",{replace:!0})}catch(p){console.log(p),p.response&&p.response.data.message?g(p.response.data.message):g(p.message)}a(!1);break}},children:e(K,{className:"py-3",children:r(B,{children:[r(c.Group,{controlId:"email",children:[e(c.Label,{children:"Email Address"}),e(c.Control,{type:"email",placeholder:"Enter your email",value:o,disabled:!0,required:!0})]}),m==="2"&&r(c.Group,{controlId:"otp",children:[e(c.Label,{children:"OTP"}),e(c.Control,{type:"text",placeholder:"Enter OTP received on email",value:h,required:!0,onChange:y=>{g(!1),u(y.target.value)}})]}),e(K,{className:"py-3",children:e(B,{children:e(O,{type:"submit",variant:"primary",children:m=="1"?"Send OTP":"Verify Email"})})})]})})})]})})})},et=()=>{const[t,n]=i.exports.useState("fetching..."),[a,s]=i.exports.useState(""),[o,f]=i.exports.useState(""),[h,u]=i.exports.useState(!1),[m,d]=i.exports.useState(!1),l=Q(),{loading:g,user:w,setLoading:b}=i.exports.useContext(R);return i.exports.useEffect(()=>{b(!0),w&&(n(w.email),b(!1))},[w]),e(G,{children:g?e(W,{}):e("div",{children:r(oe,{children:[e("h1",{children:"Change Password"}),m&&e(Y,{variant:"success",children:m}),h&&e(Y,{variant:"danger",children:h}),r(c,{onSubmit:async y=>{if(y.preventDefault(),u(!1),d(!1),a!==o){u("Passwords don't match");return}try{b(!0),await Pe({email:t,password:a}),b(!1),d("Password changed.. Redirecting to dashboard"),setTimeout(()=>{l("/dashboard",{replace:!0})},[1e3])}catch(S){console.log(S),S.response&&S.response.data.message?u(S.response.data.message):u(S.message)}},onReset:async y=>{y.preventDefault(),s(""),f(""),u(!1),d(!1)},children:[r(c.Group,{controlId:"password",children:[e(c.Label,{children:"Password"}),e(c.Control,{type:"password",placeholder:"Enter new Password",value:a,required:!0,onChange:y=>{u(!1),s(y.target.value)}})]}),r(c.Group,{controlId:"confirmPassword",children:[e(c.Label,{children:"Confirm Password"}),e(c.Control,{type:"password",placeholder:"Confirm your new Password",value:o,required:!0,onChange:y=>{u(!1),f(y.target.value)}})]}),r(K,{className:"py-3",children:[e(B,{children:e(O,{type:"submit",variant:"primary",children:"Change Password"})}),e(B,{children:e(O,{type:"reset",variant:"primary",children:"Reset"})})]})]})]})})})},tt=t=>{const{isOpen:n,setIsOpen:a,handleDelete:s,_id:o,deleting:f}=t,h=()=>a(!1);return r(Z,{show:n,onHide:h,centered:!0,children:[e(Z.Header,{closeButton:!0,children:e(Z.Title,{children:"Confirm Delete"})}),r(Z.Body,{children:[e("p",{children:"Are you sure you want to delete ?"}),e("h4",{children:o})]}),r(Z.Footer,{children:[e(O,{variant:"secondary",onClick:h,children:"Cancel"}),e(O,{variant:"danger",onClick:s,disabled:f,children:f?"Deleting":"Delete"})]})]})},nt=()=>{const[t,n]=i.exports.useState(null),[a,s]=i.exports.useState(!1),[o,f]=i.exports.useState(null),[h,u]=i.exports.useState(!1),[m,d]=i.exports.useState(!1),{user:l}=i.exports.useContext(R),g=Q();if(i.exports.useEffect(()=>{(async()=>{if(l){const v=await V0(l);if(v.error)return;n(v.docs)}})()},[l,a,h]),!t)return r("div",{children:[e("h1",{children:"Manage My Organizations"}),e(W,{})]});const w=(v,y)=>{g(`/org/${v}/create-election`,{state:y})},b=v=>{f(v),s(v)},x=async v=>{d(!0);const y=await H0(v);if(d(!1),y.error){alert("Some error occured");return}s(!1)};return r("div",{children:[e(tt,{isOpen:a,setIsOpen:s,_id:o,handleDelete:()=>x(o),deleting:m}),e(Ae,{show:h,setShow:u,setRedirect:()=>{}}),e("h2",{children:"Manage My Organizations"}),e(O,{onClick:()=>u(!0),children:"Create Organization"}),t.length===0?e("h3",{children:"No Organizations found!!"}):e(A,{as:"ol",numbered:!0,className:"my-4",children:t==null?void 0:t.map(v=>{const{organisationName:y,_id:S}=v;return r(A.Item,{as:"li",className:"d-flex flex-row",children:[r(U,{to:`/org/${S}`,style:{textDecoration:"none"},className:"flex-grow-1 px-3",children:[y,r("p",{children:["ID: ",S]})]}),e(O,{className:"align-self-center",onClick:()=>w(S,y),children:"Create Election"}),e("p",{className:"align-self-center text-danger m-3",style:{cursor:"pointer"},onClick:()=>b(S),children:"Delete"})]},S)})})]})},at=()=>{const[t,n]=i.exports.useState(null),a=ee();Q();let s=a.pathname.split("/")[2];return console.log(s),i.exports.useEffect(()=>{(async()=>{const o=await re(`organiser=${s}`);o.error||n(o)})()},[]),t?r("div",{children:[e("h2",{children:"Organization Details"}),"Id - ",s,e(A,{as:"ol",numbered:!0,className:"my-4",children:t==null?void 0:t.map(o=>{const{title:f,_id:h}=o;return e(A.Item,{as:"li",className:"d-flex flex-row",children:r(U,{to:`/elections/${h}`,style:{textDecoration:"none"},className:"flex-grow-1 px-3",children:[f,r("p",{children:["ID: ",h]})]})},h)})})]}):r("div",{children:[e("h1",{children:"Organization Details"}),e(W,{})]})},rt=()=>{const{isAuth:t,loading:n,setLoading:a,user:s}=i.exports.useContext(R),{walletId:o,setWalletId:f}=i.exports.useContext(R);let u=ee().pathname.split("/")[2];const[m,d]=I.useState(null),[l,g]=i.exports.useState({}),[w,b]=i.exports.useState(null),[x,v]=i.exports.useState(0);let y=new Date().toISOString();i.exports.useEffect(async()=>{a(!0);try{g(await fe(u)),s&&b(await ve(s.uniqueVoterId))}catch(p){console.log(p)}a(!1)},[s]),i.exports.useEffect(()=>{var p,$,E,C;(l==null?void 0:l.closeTimestamp)<new Date().toISOString()&&d("result"),s&&(((p=l==null?void 0:l.appearedVoters)==null?void 0:p.includes(s.uniqueVoterId))?v(5):(($=w==null?void 0:w.signedElections)==null?void 0:$.includes(u))?v(4):((E=l==null?void 0:l.approvedVoters)==null?void 0:E.includes(s.uniqueVoterId))?v(3):((C=l==null?void 0:l.appliedVoters)==null?void 0:C.includes(s.uniqueVoterId))?v(2):v(1))},[s,w,l]);const S=async()=>{if(!o){k.error(j("No wallet connected",null),{position:k.POSITION.BOTTOM_RIGHT,autoClose:5e3,toastId:"walletError",closeOnClick:!0,pauseOnHover:!1,draggable:!1});return}let p=JSON.stringify({voter:w._id,election:u}),$=await De(p);if(!$)return;let E={address:J.utils.toChecksumAddress(o),signature:$};const C=await K0(u,E);if(C.error){console.log(C),k.error(j(`error ${C.status}`,`${C.data||C.statusText}`),{position:k.POSITION.BOTTOM_RIGHT});return}k.success(j("Signed for Election",`${l.title}`),{position:k.POSITION.BOTTOM_RIGHT}),d("/dashboard")};return m?e(te,{replace:!0,to:m}):n?e(W,{}):r(G,{children:[e("h1",{children:"Election Details"}),"Election Title: ",l.title,e("br",{}),"OpenTimeStamp: ",new Date(l.openTimestamp).toString().split("G")[0],e("br",{}),"Election CloseTimeStamp: ",new Date(l.closeTimestamp).toString().split("G")[0],e("div",{children:t&&r(G,{children:[x===1&&e("a",{href:`${l.registrationLink}`,className:"btn btn-primary",children:"Apply"}),x===2&&e("button",{disabled:!0,className:"btn btn-primary",children:"Wait for approval"}),x===3&&e(O,{variant:"primary",onClick:async()=>{await S()},children:"Sign Wallet"}),x===4&&r(G,{children:[e(O,{href:`/elections/${u}/vote`,className:"btn btn-primary",disabled:y>l.openTimestamp&&y>l.closeTimestamp||y<l.openTimestamp&&y<l.closeTimestamp,children:"Vote"}),y>l.openTimestamp&&y>l.closeTimestamp&&e("div",{style:{color:"red"},children:"Election has finished"}),y<l.openTimestamp&&y<l.closeTimestamp&&e("div",{style:{color:"red"},children:"Election has not started yet"})]}),x===5&&e("button",{className:"btn btn-primary",disabled:!0,children:"Already Voted!"})]})})]})};const st=()=>{const t=ee();let n=t.pathname.split("/")[2],a=t.state;const[s,o]=i.exports.useState({title:"",openTimestamp:new Date().addHours(.5),closeTimestamp:new Date().addHours(1),registrationLink:""}),[f,h]=i.exports.useState(null),[u,m]=i.exports.useState(null),[d,l]=i.exports.useState(!1);i.exports.useContext(R);const g=async b=>{b.preventDefault(),l(!0);try{const x=await G0(s,n),{_id:v}=x;h(`/elections/${v}/manage`)}catch(x){console.log(x.response),m(x.response.data)}l(!1)},w=b=>{b.preventDefault(),h(`/org/${n}`)};return f?e(te,{to:f,replace:!0}):r("div",{className:"d-flex flex-column justify-content-center align-items-center",style:{height:"70vh"},children:[e("h2",{className:"my-5",children:"Create an Election"}),r(c,{onSubmit:g,onReset:w,className:"bg-light rounded px-4 py-4",style:{background:"pink",minWidth:"40%"},children:[r(c.Group,{className:"my-4",controlId:"electionTitle",children:[e(c.Label,{children:"Title"}),e(c.Control,{type:"text",placeholder:"Enter election title",value:s.title,onChange:b=>{o(x=>M(L({},x),{title:b.target.value}))}})]}),r(c.Group,{className:"my-4",controlId:"organizer",children:[e(c.Label,{children:"Organization Name"}),e(c.Control,{type:"text",value:a,disabled:!0})]}),r(c.Group,{className:"my-4",controlId:"registrationLink",children:[e(c.Label,{children:"Registration Link"}),e(c.Control,{type:"text",placeholder:"Enter Registration Link",value:s.registrationLink,onChange:b=>{o(x=>M(L({},x),{registrationLink:b.target.value}))}})]}),r("div",{className:"my-4",children:[e("label",{children:"Election Start Time"}),e("br",{}),e(le,{className:"w-100",onChange:b=>{o(x=>M(L({},x),{openTimestamp:b}))},value:s.openTimestamp,minDate:new Date,required:!0})]}),r("div",{className:"my-4",children:[e("label",{children:"Election End Time"}),e("br",{}),e(le,{className:"w-100",onChange:b=>{o(x=>M(L({},x),{closeTimestamp:b}))},value:s.closeTimestamp,minDate:new Date})]}),e("br",{}),r("div",{className:"d-flex justify-content-center",children:[e(O,{variant:"secondary",type:"reset",className:"mx-4 px-3",children:"Discard"}),e(O,{variant:"success",type:"submit",className:"mx-4 px-4",disabled:d,children:d?"Saving...":"Save"})]})]}),u&&e(Y,{variant:"danger",children:u})]})},ot=t=>{const{candidates:n,handleDeleteCandidate:a}=t;return e(G,{children:(n==null?void 0:n.length)?e(A,{as:"ol",numbered:!0,children:n.map((s,o)=>r(A.Item,{as:"li",className:"d-flex align-items-center",children:[s.name,e(O,{variant:"outline-danger",className:"ms-auto",onClick:()=>a(s._id),children:"Delete"})]},s._id))}):"No candidates"})},it=()=>{const[t,n]=i.exports.useState(!1),[a,s]=i.exports.useState(!1),[o,f]=i.exports.useState(!1),[h,u]=i.exports.useState(!1),[m,d]=i.exports.useState(!1),[l,g]=i.exports.useState(!1),w=i.exports.useRef(""),b=i.exports.useRef(!0),[x,v]=i.exports.useState([]),[y,S]=i.exports.useState({closeTimestamp:"",openTimestamp:"",organiser:"",title:"",registrationLink:""}),p=ee(),$=Q();let E=p.pathname.split("/")[2];i.exports.useEffect(()=>((async()=>{s(!0);const T=await fe(E);if(T.error){n("Invalid Election Id"),s(!1);return}T.deploymentAddress&&(alert("Election has already been deployed"),$(`/elections/${E}`,{replace:!0})),S(M(L({},T),{openTimestamp:new Date(T.openTimestamp),closeTimestamp:new Date(T.closeTimestamp)})),n(!1),s(!1)})(),()=>{n(!1),s(!1)}),[o]),i.exports.useEffect(()=>{(async()=>{const T=await ce(E);v(T)})()},[]);const C=async T=>{T.preventDefault(),u(!0);try{const q=await z0(E,y);f(X=>!X),b.current=!0}catch(q){console.log(q.response),n(q.response.data)}u(!1)},N=T=>{T.preventDefault(),b.current=!0,f(q=>!q)},F=async()=>{const T=w.current.value;if(T=="")return;d(!0);try{const X=await q0(E,{name:T})}catch(X){console.log(X.response),n(X.response.data);return}const q=await ce(E);v(q),w.current.value="",d(!1)},z=async T=>{try{const X=await F0(E,T)}catch(X){console.log(X.response),n(X.response.data);return}const q=await ce(E);v(q)},P=async()=>{g(!0);try{b.current=!1;const T=await j0(E);console.log(T),k("Election has been deployed !!",{position:k.POSITION.BOTTOM_RIGHT,autoClose:5e3,closeOnClick:!0})}catch(T){console.log(T),n("Some Error occured while deploying the Election. Please try again after some time."),b.current=!0}g(!1)};return r("div",{className:"d-flex flex-column",children:[e("h1",{children:"Manage Election"}),a?e(W,{}):r("div",{className:"d-flex justify-content-around ",children:[r(c,{onSubmit:C,onReset:N,className:"bg-light rounded px-4 py-4",style:{background:"pink",width:"40%"},children:[r(c.Group,{className:"my-4",controlId:"electionTitle",children:[e(c.Label,{children:"Title"}),e(c.Control,{type:"text",placeholder:"Enter election title",value:y.title,onChange:T=>{b.current=!1,S(q=>M(L({},q),{title:T.target.value}))}})]}),r(c.Group,{className:"my-4",controlId:"electionId",children:[e(c.Label,{children:"Election Id"}),e(c.Control,{type:"text",value:E,disabled:!0})]}),r(c.Group,{className:"my-4",controlId:"organizer",children:[e(c.Label,{children:"Organization Name"}),e(c.Control,{type:"text",value:y.organiser,disabled:!0})]}),r(c.Group,{className:"my-4",controlId:"registrationLink",children:[e(c.Label,{children:"Registration Link"}),e(c.Control,{type:"text",placeholder:"Enter Registration Link",value:y.registrationLink,onChange:T=>{b.current=!1,S(q=>M(L({},q),{registrationLink:T.target.value}))}})]}),r("div",{className:"my-4",children:[e("label",{children:"Election Start Time"}),e("br",{}),e(le,{className:"w-100",onChange:T=>{b.current=!1,S(q=>M(L({},q),{openTimestamp:T}))},value:y.openTimestamp,minDate:new Date,required:!0})]}),r("div",{className:"my-4",children:[e("label",{children:"Election End Time"}),e("br",{}),e(le,{className:"w-100",onChange:T=>{b.current=!1,S(q=>M(L({},q),{closeTimestamp:T}))},value:y.closeTimestamp,minDate:new Date})]}),e("br",{}),r("div",{className:"d-flex justify-content-center",children:[e(O,{variant:"secondary",type:"reset",className:"mx-4 px-3",children:"Discard"}),e(O,{variant:"success",type:"submit",className:"mx-4 px-4",disabled:h,children:h?"Saving...":"Save"})]})]}),r("div",{className:"text-center bg-light px-3 py-2 rounded",style:{width:"40%",overflowY:"scroll",maxHeight:"70vh"},children:[e("h3",{children:"Candidates"}),r("div",{children:[e("input",{type:"text",ref:w,placeholder:"Candidate Name",className:"rounded px-3 py-2 shadow-sm mx-2",style:{outline:"none",border:"none",width:"60%"}}),e(O,{className:"my-3",onClick:F,disabled:m,children:m?"Adding Candidate...":"Add Candidate"})]}),e(ot,{candidates:x,handleDeleteCandidate:z})]})]}),e(O,{className:"align-self-center my-4",disabled:!b.current,onClick:()=>{window.confirm(`An Election once deployed cannot be modified. 
Are you sure you want to continue?`)&&P()},children:l?"Deploying...":"Deploy Election"}),t&&e(Y,{variant:"danger",children:t})]})},lt=()=>{const t="0123456789ABCDEF";let n="#";for(let a=0;a<6;a+=1)n+=t[Math.floor(Math.random()*16)];return n},ft=t=>{let n=[];return t&&(t==null||t.forEach(({id:a,name:s,nVote:o})=>{let f={title:s,value:+o,id:a,color:lt()};n.push(f)})),n},ct={abi:[{inputs:[{internalType:"string",name:"_title",type:"string"},{internalType:"uint256",name:"_openBlockTime",type:"uint256"},{internalType:"uint256",name:"_closeBlockTime",type:"uint256"},{internalType:"string[]",name:"_names",type:"string[]"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"voter",type:"address"},{indexed:!1,internalType:"uint256",name:"nVoters",type:"uint256"}],name:"Approve",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"voter",type:"address"},{indexed:!1,internalType:"uint256",name:"nVoters",type:"uint256"}],name:"Ban",type:"event"},{anonymous:!1,inputs:[{components:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"uint256",name:"nVote",type:"uint256"},{internalType:"string",name:"name",type:"string"}],indexed:!1,internalType:"struct Election.Candidate[]",name:"candidates",type:"tuple[]"},{indexed:!1,internalType:"uint256",name:"nVotes",type:"uint256"}],name:"Vote",type:"event"},{inputs:[{internalType:"uint256",name:"_index",type:"uint256"}],name:"addVote",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"appearedVotersMap",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_address",type:"address"}],name:"approveVoter",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"approvedVotersMap",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_address",type:"address"}],name:"banVoter",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"candidates",outputs:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"uint256",name:"nVote",type:"uint256"},{internalType:"string",name:"name",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"closeBlockTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getBlockTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getCandidates",outputs:[{components:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"uint256",name:"nVote",type:"uint256"},{internalType:"string",name:"name",type:"string"}],internalType:"struct Election.Candidate[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getCurrentStatus",outputs:[{components:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"uint256",name:"nVote",type:"uint256"},{internalType:"string",name:"name",type:"string"}],internalType:"struct Election.Candidate[]",name:"",type:"tuple[]"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"isOpen",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"manager",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"nCandidates",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"nVoters",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"nVotes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"openBlockTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"title",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"}],evm:{bytecode:{object:"60806040523480156200001157600080fd5b50604051620020fc380380620020fc833981810160405281019062000037919062000390565b33600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508360069080519060200190620000909291906200017c565b5082600481905550816005819055506000600381905550600060028190555060005b815181101562000171576000604051806060016040528083815260200160008152602001848481518110620000ec57620000eb62000626565b5b60200260200101518152509050600081908060018154018082558091505060019003906000526020600020906003020160009091909190915060008201518160000155602082015181600101556040820151816002019080519060200190620001579291906200017c565b50505050808062000168906200057a565b915050620000b2565b5050505050620006c8565b8280546200018a906200050e565b90600052602060002090601f016020900481019282620001ae5760008555620001fa565b82601f10620001c957805160ff1916838001178555620001fa565b82800160010185558215620001fa579182015b82811115620001f9578251825591602001919060010190620001dc565b5b5090506200020991906200020d565b5090565b5b80821115620002285760008160009055506001016200020e565b5090565b6000620002436200023d8462000469565b62000440565b9050808382526020820190508285602086028201111562000269576200026862000689565b5b60005b85811015620002be57815167ffffffffffffffff81111562000293576200029262000684565b5b808601620002a2898262000346565b855260208501945060208401935050506001810190506200026c565b5050509392505050565b6000620002df620002d98462000498565b62000440565b905082815260208101848484011115620002fe57620002fd6200068e565b5b6200030b848285620004d8565b509392505050565b600082601f8301126200032b576200032a62000684565b5b81516200033d8482602086016200022c565b91505092915050565b600082601f8301126200035e576200035d62000684565b5b815162000370848260208601620002c8565b91505092915050565b6000815190506200038a81620006ae565b92915050565b60008060008060808587031215620003ad57620003ac62000698565b5b600085015167ffffffffffffffff811115620003ce57620003cd62000693565b5b620003dc8782880162000346565b9450506020620003ef8782880162000379565b9350506040620004028782880162000379565b925050606085015167ffffffffffffffff81111562000426576200042562000693565b5b620004348782880162000313565b91505092959194509250565b60006200044c6200045f565b90506200045a828262000544565b919050565b6000604051905090565b600067ffffffffffffffff82111562000487576200048662000655565b5b602082029050602081019050919050565b600067ffffffffffffffff821115620004b657620004b562000655565b5b620004c1826200069d565b9050602081019050919050565b6000819050919050565b60005b83811015620004f8578082015181840152602081019050620004db565b8381111562000508576000848401525b50505050565b600060028204905060018216806200052757607f821691505b602082108114156200053e576200053d620005f7565b5b50919050565b6200054f826200069d565b810181811067ffffffffffffffff8211171562000571576200057062000655565b5b80604052505050565b60006200058782620004ce565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff821415620005bd57620005bc620005c8565b5b600182019050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b600080fd5b600080fd5b600080fd5b600080fd5b600080fd5b6000601f19601f8301169050919050565b620006b981620004ce565b8114620006c557600080fd5b50565b611a2480620006d86000396000f3fe608060405234801561001057600080fd5b506004361061010b5760003560e01c806347535d7b116100a257806387ceff091161007157806387ceff09146102ac5780638a671dbb146102ca5780639b1e7e6e146102e8578063a005a48c14610304578063a3dd2619146103225761010b565b806347535d7b14610234578063481c6a75146102525780634a79d50c14610270578063727f34e21461028e5761010b565b8063119d4ddb116100de578063119d4ddb1461019857806316011867146101b45780631f3e7439146101e45780633477ee2e146102025761010b565b80630383badc1461011057806305a72eba1461012c57806306a49fce1461015c578063081e5b751461017a575b600080fd5b61012a60048036038101906101259190610f06565b610345565b005b61014660048036038101906101419190610ed9565b6105d2565b6040516101539190611446565b60405180910390f35b6101646105f2565b6040516101719190611385565b60405180910390f35b6101826106f7565b60405161018f9190611583565b60405180910390f35b6101b260048036038101906101ad9190610ed9565b6106fd565b005b6101ce60048036038101906101c99190610ed9565b6108c8565b6040516101db9190611446565b60405180910390f35b6101ec6108e8565b6040516101f99190611583565b60405180910390f35b61021c60048036038101906102179190610f06565b6108ee565b60405161022b9392919061159e565b60405180910390f35b61023c6109b0565b6040516102499190611446565b60405180910390f35b61025a6109cb565b6040516102679190611341565b60405180910390f35b6102786109f1565b6040516102859190611461565b60405180910390f35b610296610a7f565b6040516102a39190611583565b60405180910390f35b6102b4610a8b565b6040516102c19190611583565b60405180910390f35b6102d2610a93565b6040516102df9190611583565b60405180910390f35b61030260048036038101906102fd9190610ed9565b610a99565b005b61030c610cf0565b6040516103199190611583565b60405180910390f35b61032a610cf6565b60405161033c969594939291906113a7565b60405180910390f35b60045442101561038a576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610381906114c3565b60405180910390fd5b6005544211156103cf576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016103c690611523565b60405180910390fd5b600760003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff1661045b576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161045290611503565b60405180910390fd5b600860003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16156104e8576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016104df906114a3565b60405180910390fd5b6001600860003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055506000818154811061055457610553611826565b5b906000526020600020906003020160010160008154809291906105769061177f565b91905055506003600081548092919061058e9061177f565b91905055507f7caae67c962494f25046918fb68657a7078d3adaf01f441f8180647c7bbb12cb60006003546040516105c7929190611416565b60405180910390a150565b60086020528060005260406000206000915054906101000a900460ff1681565b60606000805480602002602001604051908101604052809291908181526020016000905b828210156106ee5783829060005260206000209060030201604051806060016040529081600082015481526020016001820154815260200160028201805461065d90611733565b80601f016020809104026020016040519081016040528092919081815260200182805461068990611733565b80156106d65780601f106106ab576101008083540402835291602001916106d6565b820191906000526020600020905b8154815290600101906020018083116106b957829003601f168201915b50505050508152505081526020019060010190610616565b50505050905090565b60055481565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161461078d576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161078490611543565b60405180910390fd5b600760008273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff161561081a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161081190611563565b60405180910390fd5b6001600760008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff021916908315150217905550600260008154809291906108859061177f565b91905055507f90ec57f18fa7b15c6b8d5e4d1deb90796c74b2ff23d4d0cecad0cb42a96b3128816002546040516108bd92919061135c565b60405180910390a150565b60076020528060005260406000206000915054906101000a900460ff1681565b60035481565b600081815481106108fe57600080fd5b906000526020600020906003020160009150905080600001549080600101549080600201805461092d90611733565b80601f016020809104026020016040519081016040528092919081815260200182805461095990611733565b80156109a65780601f1061097b576101008083540402835291602001916109a6565b820191906000526020600020905b81548152906001019060200180831161098957829003601f168201915b5050505050905083565b600042600454111580156109c657506005544211155b905090565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600680546109fe90611733565b80601f0160208091040260200160405190810160405280929190818152602001828054610a2a90611733565b8015610a775780601f10610a4c57610100808354040283529160200191610a77565b820191906000526020600020905b815481529060010190602001808311610a5a57829003601f168201915b505050505081565b60008080549050905090565b600042905090565b60025481565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610b29576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610b2090611543565b60405180910390fd5b600760008273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16610bb5576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610bac906114e3565b60405180910390fd5b600860008273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff1615610c42576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610c3990611483565b60405180910390fd5b6000600760008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff02191690831515021790555060026000815480929190610cad90611709565b91905055507f357a3f1cf67c910fe298ca632230d82fcc73d127146d317a885d4dac07c2a5dd81600254604051610ce592919061135c565b60405180910390a150565b60045481565b606060008060008060606000600254600354600454600554600685805480602002602001604051908101604052809291908181526020016000905b82821015610e0957838290600052602060002090600302016040518060600160405290816000820154815260200160018201548152602001600282018054610d7890611733565b80601f0160208091040260200160405190810160405280929190818152602001828054610da490611733565b8015610df15780601f10610dc657610100808354040283529160200191610df1565b820191906000526020600020905b815481529060010190602001808311610dd457829003601f168201915b50505050508152505081526020019060010190610d31565b505050509550808054610e1b90611733565b80601f0160208091040260200160405190810160405280929190818152602001828054610e4790611733565b8015610e945780601f10610e6957610100808354040283529160200191610e94565b820191906000526020600020905b815481529060010190602001808311610e7757829003601f168201915b50505050509050955095509550955095509550909192939495565b600081359050610ebe816119c0565b92915050565b600081359050610ed3816119d7565b92915050565b600060208284031215610eef57610eee611855565b5b6000610efd84828501610eaf565b91505092915050565b600060208284031215610f1c57610f1b611855565b5b6000610f2a84828501610ec4565b91505092915050565b6000610f3f838361126c565b905092915050565b6000610f5383836112bc565b905092915050565b610f648161168e565b82525050565b6000610f7582611616565b610f7f8185611651565b935083602082028501610f91856115dc565b8060005b85811015610fcd5784840389528151610fae8582610f33565b9450610fb983611637565b925060208a01995050600181019050610f95565b50829750879550505050505092915050565b6000610fea82611621565b610ff48185611651565b935083602082028501611006856115ec565b8060005b85811015611041578484038952816110228582610f47565b945061102d83611644565b925060208a0199505060018101905061100a565b50829750879550505050505092915050565b61105c816116a0565b82525050565b600061106d8261162c565b6110778185611662565b93506110878185602086016116d6565b6110908161185a565b840191505092915050565b60006110a68261162c565b6110b08185611673565b93506110c08185602086016116d6565b6110c98161185a565b840191505092915050565b600081546110e181611733565b6110eb8186611662565b9450600182166000811461110657600181146111185761114b565b60ff198316865260208601935061114b565b61112185611601565b60005b8381101561114357815481890152600182019150602081019050611124565b808801955050505b50505092915050565b6000611161600d83611673565b915061116c82611878565b602082019050919050565b6000611184601683611673565b915061118f826118a1565b602082019050919050565b60006111a7601d83611673565b91506111b2826118ca565b602082019050919050565b60006111ca601b83611673565b91506111d5826118f3565b602082019050919050565b60006111ed601c83611673565b91506111f88261191c565b602082019050919050565b6000611210601583611673565b915061121b82611945565b602082019050919050565b6000611233601083611673565b915061123e8261196e565b602082019050919050565b6000611256601d83611673565b915061126182611997565b602082019050919050565b60006060830160008301516112846000860182611323565b5060208301516112976020860182611323565b50604083015184820360408601526112af8282611062565b9150508091505092915050565b60006060830160008084015490506112d381611765565b6112e06000870182611323565b50600184015490506112f181611765565b6112fe6020870182611323565b5060028401858303604087015261131583826110d4565b925050819250505092915050565b61132c816116cc565b82525050565b61133b816116cc565b82525050565b60006020820190506113566000830184610f5b565b92915050565b60006040820190506113716000830185610f5b565b61137e6020830184611332565b9392505050565b6000602082019050818103600083015261139f8184610f6a565b905092915050565b600060c08201905081810360008301526113c18189610f6a565b90506113d06020830188611332565b6113dd6040830187611332565b6113ea6060830186611332565b6113f76080830185611332565b81810360a0830152611409818461109b565b9050979650505050505050565b600060408201905081810360008301526114308185610fdf565b905061143f6020830184611332565b9392505050565b600060208201905061145b6000830184611053565b92915050565b6000602082019050818103600083015261147b818461109b565b905092915050565b6000602082019050818103600083015261149c81611154565b9050919050565b600060208201905081810360008301526114bc81611177565b9050919050565b600060208201905081810360008301526114dc8161119a565b9050919050565b600060208201905081810360008301526114fc816111bd565b9050919050565b6000602082019050818103600083015261151c816111e0565b9050919050565b6000602082019050818103600083015261153c81611203565b9050919050565b6000602082019050818103600083015261155c81611226565b9050919050565b6000602082019050818103600083015261157c81611249565b9050919050565b60006020820190506115986000830184611332565b92915050565b60006060820190506115b36000830186611332565b6115c06020830185611332565b81810360408301526115d2818461109b565b9050949350505050565b6000819050602082019050919050565b60008190508160005260206000209050919050565b60008190508160005260206000209050919050565b600081519050919050565b600081549050919050565b600081519050919050565b6000602082019050919050565b6000600382019050919050565b600082825260208201905092915050565b600082825260208201905092915050565b600082825260208201905092915050565b6000819050919050565b6000611699826116ac565b9050919050565b60008115159050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b60005b838110156116f45780820151818401526020810190506116d9565b83811115611703576000848401525b50505050565b6000611714826116cc565b91506000821415611728576117276117c8565b5b600182039050919050565b6000600282049050600182168061174b57607f821691505b6020821081141561175f5761175e6117f7565b5b50919050565b60006117786117738361186b565b611684565b9050919050565b600061178a826116cc565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8214156117bd576117bc6117c8565b5b600182019050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b600080fd5b6000601f19601f8301169050919050565b60008160001c9050919050565b7f616c726561647920766f74656400000000000000000000000000000000000000600082015250565b7f796f75206861766520616c726561647920766f74656400000000000000000000600082015250565b7f766f74696e6720706861736520686173206e6f7420737461727465642e000000600082015250565b7f726571756972657320616e20617070726f7665642077616c6c65740000000000600082015250565b7f796f7520617265206e6f7420656c696769626c6520746f20766f746500000000600082015250565b7f766f74696e67207068617365206973206f7665722e0000000000000000000000600082015250565b7f7265717569726573206d616e6167657200000000000000000000000000000000600082015250565b7f726571756972657320616e20756e617070726f7665642077616c6c6574000000600082015250565b6119c98161168e565b81146119d457600080fd5b50565b6119e0816116cc565b81146119eb57600080fd5b5056fea2646970667358221220105cff72cacaaf0fa256fdc0c9e0df5d4a8a7b15eec4369455461ffd3637224f64736f6c63430008070033"}}};function Me(t){return new J.eth.Contract(ct.abi,t)}const dt=async t=>(await Me(t).methods.getCurrentStatus().call())[0],ut=()=>{const[t,n]=i.exports.useState({}),[a,s]=i.exports.useState([]);let f=ee().pathname.split("/")[2];i.exports.useEffect(()=>{(async()=>{const d=await fe(f);d.error||n(d)})()},[]);let h=t==null?void 0:t.deploymentAddress,u=new Date(t==null?void 0:t.openTimestamp)<=new Date,m=new Date(t==null?void 0:t.closeTimestamp)<new Date;return i.exports.useEffect(()=>{(async()=>{if(m&&(t==null?void 0:t.deploymentAddress)){const d=await dt(t.deploymentAddress);s(ft(d)),console.log(d)}})()},[t]),!h||!u?r("div",{children:[e("h2",{children:"Election Result Page"}),"Election hasn't started yet. Please check after sometime."]}):m?r("div",{children:[e("h2",{children:"Election Result Page"}),r("p",{children:["Election Id: ",f]}),r("p",{children:["Election Name: ",t.title]}),r("div",{className:"d-flex flex-column align-items-center",children:[e("div",{className:"py-5",style:{maxWidth:"60%"},children:e(o0,{data:a,label:d=>{const{dataEntry:l}=d;return l.percentage===0?"":`${Math.round(l.percentage)} %`},labelStyle:d=>({fontSize:"5px",textAlign:"center",cursor:"pointer"}),startAngle:-90,animate:!0})}),r(i0,{striped:!0,bordered:!0,hover:!0,children:[e("thead",{children:r("tr",{children:[e("th",{children:"Id"}),e("th",{children:"Candidate Name"}),e("th",{children:"Votes Received"})]})}),e("tbody",{children:a==null?void 0:a.map(d=>{const{id:l,title:g,value:w}=d;return r("tr",{children:[e("td",{children:l}),e("td",{children:g}),e("td",{children:w})]},l)})})]})]})]}):r("div",{children:[e("h2",{children:"Election Result Page"}),"Election is in progress. Please check after sometime."]})},pt=()=>{const[t,n]=i.exports.useState(""),[a,s]=i.exports.useState(""),[o,f]=i.exports.useState(""),[h,u]=i.exports.useState(""),[m,d]=i.exports.useState(!1),[l,g]=i.exports.useState(!1),[w,b]=i.exports.useState(X0[0].value),x=Q(),{isAuth:v,setIsAuth:y,loading:S,setLoading:p}=i.exports.useContext(R);return i.exports.useEffect(()=>{y("token"in localStorage),v&&(p(!1),x("/dashboard",{replace:!0}))},[v]),e(G,{children:S?e(W,{}):e(G,{children:e("div",{children:r(oe,{children:[e("h1",{children:"Forgot Password"}),l&&e(Y,{variant:"success",children:l}),m&&e(Y,{variant:"danger",children:m}),r(c,{onSubmit:async E=>{if(E.preventDefault(),d(!1),g(!1),o!==h){d("Passwords don't match");return}switch(w){case"1":p(!0);const C="OTP for Forgot Password";try{await $e({email:t,purpose:C}),b("2")}catch(N){console.log(N),N.response&&N.response.data.message?d(N.response.data.message):d(N.message)}p(!1);break;case"2":p(!0);try{await Le({email:t,otp:a}),b("3")}catch(N){console.log(N),N.response&&N.response.data.message?d(N.response.data.message):d(N.message)}p(!1);break;case"3":p(!0);try{await Pe({email:t,password:o}),g("Password has been changed")}catch(N){console.log(N),N.response&&N.response.data.message?d(N.response.data.message):d(N.message)}p(!1);break}},children:[(w==="1"||w==="2")&&r(c.Group,{controlId:"email",children:[e(c.Label,{children:"Email Address"}),e(c.Control,{type:"email",placeholder:"Enter your email",value:t,required:!0,onChange:E=>{d(!1),n(E.target.value)}})]}),w==="2"&&r(c.Group,{controlId:"otp",children:[e(c.Label,{children:"OTP"}),e(c.Control,{type:"text",placeholder:"Enter OTP received on email",value:a,required:!0,onChange:E=>{d(!1),s(E.target.value)}})]}),w==="3"&&r(c.Group,{controlId:"password",children:[e(c.Label,{children:"Password"}),e(c.Control,{type:"password",placeholder:"Enter new Password",value:o,required:!0,onChange:E=>{d(!1),f(E.target.value)}})]}),w==="3"&&r(c.Group,{controlId:"confirmPassword",children:[e(c.Label,{children:"Confirm Password"}),e(c.Control,{type:"password",placeholder:"Confirm your new Password",value:h,required:!0,onChange:E=>{d(!1),u(E.target.value)}})]}),e(K,{className:"py-3",children:e(B,{children:e(O,{type:"submit",variant:"primary",children:w=="1"?"Send OTP":w=="2"?"Confirm OTP":"Change Password"})})})]})]})})})})};var ht="./assets/fourOfour.e2f25f95.jpeg";const mt=()=>{const{loading:t,isAuth:n,setIsAuth:a}=i.exports.useContext(R);return i.exports.useEffect(()=>{a("token"in localStorage)}),e("div",{children:t?e(W,{}):r(G,{children:[r(U,{to:n?"/dashboard":"/",children:[e(l0,{}),"Go back to the home page"]}),e("img",{src:ht})]})})},bt=()=>{const{user:t,setUser:n,setIsAuth:a,setLoading:s}=i.exports.useContext(R),o=localStorage.getItem("token"),[f,h]=i.exports.useState(!1);return i.exports.useEffect(()=>{(async()=>{if(o&&!t){const u=await $0();u.error?(a(!1),s(!1),h(!0)):(n(u),a(!0))}})()},[o]),f?(localStorage.removeItem("token"),e(te,{to:"/"})):(console.log("via private route"),o?e(Oe,{}):e(te,{to:"/login"}))},gt=()=>(console.log("Organizer route"),e(Oe,{})),we=({election:t})=>e(D,{className:"m-2 py-2 rounded ",style:{width:"25vw"},children:r(D.Body,{children:[e(D.Title,{children:e("a",{href:`/elections/${t._id}`,children:t.title})}),r(D,{className:"py-2 rounded",children:[r(D.Text,{style:{color:"green"},children:["Opening Time:",e("br",{}),new Date(t.openTimestamp).toString()]}),r(D.Text,{style:{color:"red"},children:["Closing Time:",e("br",{}),new Date(t.closeTimestamp).toString()]})]})]})}),yt=()=>{const{loading:t,setLoading:n}=i.exports.useContext(R);ee();const[a,s]=i.exports.useState([]),[o,f]=i.exports.useState([]),[h,u]=i.exports.useState([]),[m,d]=i.exports.useState([]);return i.exports.useEffect(async()=>{n(!0);let l=new Date().toISOString();try{s(await re("")),f(a.filter(g=>l>=g.openTimestamp&&l<=g.closeTimestamp)),u(a.filter(g=>g.openTimestamp>l&&g.closeTimestamp>l)),d(a.filter(g=>g.closeTimestamp<l))}catch(g){console.log(g)}n(!1)},[a]),t?e(W,{}):e(G,{children:r(K,{children:[e("h2",{children:"Active Elections"}),o.length>0?o==null?void 0:o.map(l=>e(B,{sm:12,md:6,lg:4,xl:3,children:e(we,{election:l})},l._id)):e("h4",{children:"No active elections!"}),e("hr",{style:{border:"2px solid gray"},className:"my-3"}),e("h2",{children:"Upcoming Elections"}),h.length>0?h==null?void 0:h.map(l=>e(B,{sm:12,md:6,lg:4,xl:3,children:e(we,{election:l})},l._id)):e("h4",{children:"No upcoming elections!"}),e("hr",{style:{border:"2px solid gray"},className:"my-3"}),e("h2",{children:"Past Elections"}),m.length>0?m==null?void 0:m.map(l=>e(B,{sm:12,md:6,lg:4,xl:3,children:e(we,{election:l})},l._id)):e("h4",{children:"No past elections!"})]})})},vt=()=>{let t=location.pathname.split("/")[2];const{loading:n,setLoading:a}=i.exports.useContext(R),{walletId:s,chainId:o,user:f}=i.exports.useContext(R),[h,u]=i.exports.useState(!1),[m,d]=i.exports.useState({}),[l,g]=i.exports.useState(null),[w,b]=i.exports.useState([]),[x,v]=i.exports.useState(null),[y,S]=i.exports.useState(new Date().toString()),[p,$]=I.useState(null);setTimeout(()=>{S(new Date().toString())},1e3),i.exports.useEffect(async()=>{a(!0);try{console.log(t),d(await fe(t)),b(await ce(t))}catch(C){console.log(C)}a(!1)},[]),i.exports.useEffect(()=>{let C=m.deploymentAddress;g(Me(C))},[m]),i.exports.useEffect(()=>{var C;((C=m==null?void 0:m.appearedVoters)==null?void 0:C.includes(f==null?void 0:f.uniqueVoterId))&&$(`/elections/${t}`)},[m,f]);const E=async()=>{if(u(!0),!s){k.error(j("No wallet connected",null),{position:k.POSITION.BOTTOM_RIGHT,autoClose:5e3,toastId:"walletError",closeOnClick:!0,pauseOnHover:!1,draggable:!1}),u(!1);return}if(o!==me){k.error(j("Invalid chain",`switch to ${he(me)}`),{position:k.POSITION.BOTTOM_RIGHT,autoClose:5e3,toastId:"chainError",closeOnClick:!0,pauseOnHover:!1,draggable:!1}),u(!1);return}console.log(x),console.log(m.deploymentAddress);try{let C=await l.methods.getCandidates().call();console.log(C);let N=null;C.forEach(P=>{P.name===x.name&&(N=parseInt(P.id))}),console.log(N);const{transactionHash:F}=await l.methods.addVote(N).send({from:s});console.log(F);const z=await W0(t);console.log(z),k.success(j("Casted vote for",x.name),{position:k.POSITION.BOTTOM_RIGHT,autoClose:5e3,toastId:"voteSuccess",closeOnClick:!0,pauseOnHover:!1,draggable:!1}),u(!1),$(`/elections/${t}`)}catch(C){console.log(C),k.error(j(C.message,null),{position:k.POSITION.BOTTOM_RIGHT,autoClose:5e3,toastId:"voteError",closeOnClick:!0,pauseOnHover:!1,draggable:!1})}u(!1)};return p?e(te,{replace:!0,to:p}):n?e(W,{}):e(I.Fragment,{children:r(K,{children:[r(B,{md:5,children:[e(D,{style:{width:"18rem"},children:r(D.Body,{children:["Current Time:",e(D.Text,{children:y})]})}),e("br",{}),e(D,{style:{width:"18rem"},children:r(D.Body,{children:[e(D.Title,{children:m.title}),"Opening Time:",e(D.Text,{style:{color:"green"},children:new Date(m.openTimestamp).toString()}),"Closing Time:",e(D.Text,{style:{color:"red"},children:new Date(m.closeTimestamp).toString()})]})})]}),r(B,{md:6,children:[x?`Selected Candidate is ${x.name} `:"Click on a candidate to VOTE",x&&e(O,{variant:"primary",onClick:E,className:"my-2",children:h?"Voting...":"Vote"}),e("br",{}),e(D,{style:{width:"36rem"},children:r(D.Body,{children:[e(D.Title,{children:"Candidates"}),w.map((C,N)=>e(A.Item,{className:"d-flex align-items-center btn btn-outline-dark",onClick:()=>v(w[N]),children:C.name},C._id))]})})]})]})})},wt=()=>{const{chainId:t,setChainId:n}=i.exports.useContext(R);return r(f0,{children:[r("main",{className:"App py-3 bg-gray",children:[e(ne,{children:e(v0,{})}),t!==me&&r("p",{className:"alert alert-warning text-center",style:{padding:0,marginTop:0},children:["You are currently on"," ",e("span",{className:"fw-bold",children:he(t)}),", please switch to ",e("span",{className:"fw-bold",children:he(80001)}),". You can follow these"," ",e("span",{children:e("a",{className:"fw-bold",target:"_blank",rel:"noreferrer",href:"https://docs.polygon.technology/docs/develop/metamask/config-polygon-on-metamask/",children:"steps"})})]}),e(ne,{children:r(c0,{children:[e(_,{path:"*",element:e(mt,{})}),e(_,{exact:!0,path:"/",element:e(P0,{})}),e(_,{path:"/login",element:e(B0,{})}),e(_,{path:"/signup",element:e(R0,{})}),e(_,{path:"/forgotpassword",element:e(pt,{})}),e(_,{path:"/explore",element:e(yt,{})}),r(_,{path:"/",element:e(bt,{}),children:[e(_,{exact:!0,path:"/dashboard",element:e(J0,{})}),e(_,{exact:!0,path:"/dashboard/wallet",element:e(Y0,{})}),e(_,{exact:!0,path:"/elections/:id",element:e(rt,{})}),e(_,{exact:!0,path:"/elections/:id/vote",element:e(vt,{})}),e(_,{exact:!0,path:"/elections/:id/result",element:e(ut,{})}),e(_,{exact:!0,path:"/elections/:id/manage",element:e(it,{})}),e(_,{exact:!0,path:"/verifyEmail",element:e(Z0,{})}),e(_,{exact:!0,path:"/changePassword",element:e(et,{})}),r(_,{path:"/org",element:e(gt,{}),children:[e(_,{path:"/org",element:e(nt,{})}),e(_,{path:"/org/:id",element:e(at,{})}),e(_,{path:"/org/:id/create-election",element:e(st,{})})]})]})]})})]}),e(d0,{style:{width:"30em"}})]})};u0.render(e(h0,{children:e(wt,{})}),document.getElementById("root"));
